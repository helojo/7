<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C学习笔记（8）--- 文件读写' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C学习笔记（8）--- 文件读写</center></div><div class='banquan'>原文出处:本文由博客园博主Parachute黑喵提供。<br/>
原文连接:https://www.cnblogs.com/cptCarlvon/p/11904292.html</div><br>
    <p><strong><span style="font-family: 黑体; font-size: 15px;">1.C&nbsp;<span class="color_h1">文件读写:</span></span></strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;">一个文件，无论它是文本文件还是二进制文件，都是代表了一系列的字节。C 语言不仅提供了访问顶层的函数，也提供了底层（OS）调用来处理存储设备上的文件。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;">a.打开文件：</span></p>
<p>&nbsp;</p>
<p><strong><span style="font-family: 黑体;"><span style="font-size: 15px;">FILE *fopen( const char * filename, const char * mode );</span></span></strong></p>
<p><span style="font-family: 黑体;"><span style="font-size: 15px;">filemame是文件名，mode是指模式---比如说 "r" 指</span></span><span style="color: #333333; font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Noto Sans CJK SC', 'WenQuanYi Micro Hei', Arial, sans-serif; font-size: 13px;">打开一个已有的文本文件，允许读取文件。详情网上随便都有。</span></p>
<p>&nbsp;</p>
<p>&nbsp;sub:&nbsp; 如果fopen显示不安全，就声明一个&nbsp; &nbsp; &nbsp; &nbsp; <strong>#define _CRT_SECURE_NO_WARNINGS</strong></p>
<p>&nbsp;</p>
<p><span style="color: #333333; font-family: 黑体; font-size: 15px;">b.关闭文件：</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;"><strong><span style="color: #333333; font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Noto Sans CJK SC', 'WenQuanYi Micro Hei', Arial, sans-serif;">int fclose( FILE *fp );</span></strong></span></p>
<p><span style="font-family: 黑体; font-size: 15px;"><span style="color: #333333;">如果成功关闭文件，</span><strong style="color: #333333; font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Noto Sans CJK SC', 'WenQuanYi Micro Hei', Arial, sans-serif; font-size: 13px;">fclose( )</strong><span style="color: #333333;">&nbsp;函数返回零，如果关闭文件时发生错误，函数返回&nbsp;</span><strong style="color: #333333; font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Noto Sans CJK SC', 'WenQuanYi Micro Hei', Arial, sans-serif; font-size: 13px;">EOF</strong><span style="color: #333333;">。这个函数实际上，会清空缓冲区中的数据，关闭文件，并释放用于该文件的所有内存。EOF 是一个定义在头文件&nbsp;</span><strong style="color: #333333; font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Noto Sans CJK SC', 'WenQuanYi Micro Hei', Arial, sans-serif; font-size: 13px;">stdio.h</strong><span style="color: #333333;">&nbsp;中的常量。</span></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;"><span style="color: #333333;">c.写入文件：</span></span></p>
<p>&nbsp;</p>
<p><strong><span style="font-family: 黑体; font-size: 15px;"><span style="color: #333333;">int fputc( int c, FILE *fp );</span></span></strong></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;"><span style="color: #333333;">函数&nbsp;<strong>fputc()</strong>&nbsp;把参数 c 的字符值写入到 fp 所指向的输出流中。如果写入成功，它会返回写入的字符，如果发生错误，则会返回&nbsp;<strong>EOF</strong>。</span></span></p>
<p>&nbsp;</p>
<p><strong><span style="font-family: 黑体; font-size: 15px;"><span style="color: #333333;">int fputs( const char *s, FILE *fp );</span></span></strong></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;"><span style="color: #333333;">函数&nbsp;fputs()&nbsp;把字符串&nbsp;s&nbsp;写入到 fp 所指向的输出流中。如果写入成功，它会返回一个非负值，如果发生错误，则会返回&nbsp;EOF。您也可以使用:</span></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;"><span style="color: #333333;"><strong>int fprintf(FILE *fp,const char *format, ...)</strong>&nbsp;</span></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;"><span style="color: #333333;">函数来写把一个字符串写入到文件中。</span></span></p>
<p><span style="font-family: 黑体; font-size: 15px;"><span style="color: #333333;">&nbsp;</span></span></p>
<p><span style="color: #333333;">d.读取文件：</span></p>
<p>&nbsp;</p>
<p>下面是从文件读取单个字符的最简单的函数</p>
<p><strong><span style="font-family: 黑体; font-size: 15px;"><span style="color: #333333;">int fgetc( FILE * fp );</span></span></strong></p>
<p>&nbsp;</p>
<p>如果是字符串：</p>
<p><strong>char *fgets( char *buf, int n, FILE *fp );</strong></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;">函数&nbsp;fgets()&nbsp;从 fp 所指向的输入流中读取 n - 1 个字符。它会把读取的字符串复制到缓冲区&nbsp;buf，并在最后追加一个&nbsp;null&nbsp;字符来终止字符串。</span></p>
<p><span style="font-family: 黑体; font-size: 15px;">如果这个函数在读取最后一个字符之前就遇到一个换行符 '\n' 或文件的末尾 EOF，则只会返回读取到的字符，包括换行符。</span></p>
<p>&nbsp;</p>
<p class="tutheader"><span style="font-family: 黑体; font-size: 15px;">e. 二进制 I/O 函数：</span></p>
<p class="tutheader">&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;">下面两个函数用于二进制输入和输出：</span></p>
<p>&nbsp;</p>
<div class="example">
<div class="example_code">
<div class="hl-main"><strong><span class="hl-identifier" style="font-family: 黑体; font-size: 15px;">size_t<span class="hl-code"> <span class="hl-identifier">fread<span class="hl-brackets">(<span class="hl-types">void<span class="hl-code"> *<span class="hl-identifier">ptr<span class="hl-code">, <span class="hl-identifier">size_t<span class="hl-code"> <span class="hl-identifier">size_of_elements<span class="hl-code">, <span class="hl-identifier">size_t<span class="hl-code"> <span class="hl-identifier">number_of_elements<span class="hl-code">, <span class="hl-identifier">FILE<span class="hl-code"> *<span class="hl-identifier">a_file<span class="hl-brackets">)<span class="hl-code">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></strong>
<div class="hl-main">&nbsp;
<div class="hl-main"><strong><span class="hl-identifier" style="font-family: 黑体; font-size: 15px;"><span class="hl-code"><span class="hl-identifier"><span class="hl-brackets"><span class="hl-types"><span class="hl-code"><span class="hl-identifier"><span class="hl-code"><span class="hl-identifier"><span class="hl-code"><span class="hl-identifier"><span class="hl-code"><span class="hl-identifier"><span class="hl-code"><span class="hl-identifier"><span class="hl-code"><span class="hl-identifier"><span class="hl-code"><span class="hl-identifier"><span class="hl-brackets"><span class="hl-code"> <span class="hl-identifier">size_t<span class="hl-code"> <span class="hl-identifier">fwrite<span class="hl-brackets">(<span class="hl-types">const<span class="hl-code"> <span class="hl-types">void<span class="hl-code"> *<span class="hl-identifier">ptr<span class="hl-code">, <span class="hl-identifier">size_t<span class="hl-code"> <span class="hl-identifier">size_of_elements<span class="hl-code">, <span class="hl-identifier">size_t<span class="hl-code"> <span class="hl-identifier">number_of_elements<span class="hl-code">, <span class="hl-identifier">FILE<span class="hl-code"> *<span class="hl-identifier">a_file<span class="hl-brackets">)<span class="hl-code">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></strong>
<div class="hl-main">&nbsp;


<p><span style="font-family: 黑体; font-size: 15px;">这两个函数都是用于存储块的读写 - 通常是数组或结构体。</span></p>
<p>&nbsp;</p>
<p>f.在指定位置开始读取：</p>
<p>&nbsp;</p>
<p>fseek 可以移动文件指针到指定位置读,或插入写</p>
<p>具体：</p>
<p>&nbsp;</p>
<p><strong>int fseek(FILE *stream, long offset, int whence);</strong></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;">fseek 设置当前读写点到 offset 处, whence 可以是 SEEK_SET,SEEK_CUR,SEEK_END 这些值决定是从文件头、当前点和文件尾计算偏移量 offset。</span></p>
<p><span style="font-family: 黑体; font-size: 15px;">你可以定义一个文件指针<span class="marked">&nbsp;FILE *fp,当你打开一个文件时，文件指针指向开头，你要指到多少个字节，只要控制偏移量就好，例如, 相对当前位置往后移动一个字节：<span class="marked">fseek(fp,1,SEEK_CUR);&nbsp;中间的值就是偏移量。 如果你要往前移动一个字节，直接改为负值就可以：</span></span></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;"><span class="marked"><span class="marked"><strong><span class="marked">fseek(fp,-1,SEEK_CUR)；</span></strong></span></span></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;"><span class="marked"><span class="marked"><span class="marked">注意：&nbsp;只有用&nbsp;<span class="marked">r+&nbsp;模式打开文件才能插入内容，<span class="marked">w&nbsp;或&nbsp;<span class="marked">w+&nbsp;模式都会清空掉原来文件的内容再来写，<span class="marked">a&nbsp;或&nbsp;<span class="marked">a+&nbsp;模式即总会在文件最尾添加内容，哪怕用 fseek() 移动了文件指针位置。</span></span></span></span></span></span></span></span></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 15px;"><span class="marked"><span class="marked"><span class="marked"><span class="marked"><span class="marked"><span class="marked"><span class="marked"><span class="marked">引用：<a href="https://www.runoob.com/cprogramming/c-file-io.html">https://www.runoob.com/cprogramming/c-file-io.html</a></span></span></span></span></span></span></span></span></span></p>

</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>