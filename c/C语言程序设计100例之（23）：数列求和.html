<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C语言程序设计100例之（23）：数列求和' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C语言程序设计100例之（23）：数列求和</center></div><div class='banquan'>原文出处:本文由博客园博主aTeacher提供。<br/>
原文连接:https://www.cnblogs.com/cs-whut/p/12021090.html</div><br>
    <h4><span style="font-size: 18px;">例23&nbsp; 数列求和</span></h4>
<p><strong>问题描述</strong></p>
<p>已知某数列前两项为2和3，其后继项根据前面最后两项的乘积，按下列规则生成：</p>
<p>① 若乘积为一位数，则该乘积即为数列的后继项；</p>
<p>② 若乘积为二位数，则该乘积的十位上的数字和个位上的数字依次作为数列的两个后继项。</p>
<p>输出该数列的前Ｎ项及它们的和。</p>
<p><strong>输入格式</strong></p>
<p>一个整数N（2&le;N&le;1000）。</p>
<p><strong>输出格式</strong></p>
<p>第1行输出该数列的前Ｎ项的和。</p>
<p>第2行输出该数列的前N项。</p>
<p><strong>输入样例</strong></p>
<p>10</p>
<p><strong>输出样例</strong></p>
<p>sum(10)=44</p>
<p>2 3 6 1 8 8 6 4 2 4</p>
<h5><span style="font-size: 16px;">&nbsp; &nbsp; &nbsp; &nbsp; （1）编程思路。</span></h5>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 编写函数int sum(int *pa, int n)按数列的生成方法生成数列的前n项并保存在数组pa中，同时将前n项的和作为函数值返回。</p>
<h5><span style="font-size: 16px;">&nbsp; &nbsp; &nbsp; &nbsp; （2）源程序。</span></h5>
<p style="margin-left: 30px;">#include &lt;stdio.h&gt;</p>
<p style="margin-left: 30px;">#define MAXNUM 1001</p>
<p style="margin-left: 30px;">int sum(int *pa, int n);</p>
<p style="margin-left: 30px;">int main()</p>
<p style="margin-left: 30px;">{</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int n,num[MAXNUM];</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; scanf("%d",&amp;n);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; printf("sum(%d)=%d\n",n,sum(num,n));</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; for (int i=0;i&lt;n;i++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d ",num[i]);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; printf("\n");</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</p>
<p style="margin-left: 30px;">}</p>
<p style="margin-left: 30px;">int sum(int *pa, int n)</p>
<p style="margin-left: 30px;">{</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int count, total, temp;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; *pa = 2;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; *(++pa)=3;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; total=5;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; count=2;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; while (count++&lt;n)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; temp = *(pa-1) * (*pa);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (temp&lt;10)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total+=temp;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(++pa) = temp;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(++pa)= temp/10;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total += *pa;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (count++&lt;n)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(++pa) = temp%10;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total += *pa;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; return total;</p>
<p style="margin-left: 30px;">}</p>
<h4><span style="font-size: 18px;">习题23</span></h4>
<h5><span style="font-size: 16px;">23-1&nbsp; 序列求和</span></h5>
<p><strong>问题描述</strong></p>
<p>有一个序列，初始时只有两个数x和y，之后每次操作时，在原序列的任意两个相邻数之间插入这两个数的和，得到新序列。举例说明：</p>
<p>初始：1 2</p>
<p>操作1次：1 3 2</p>
<p>操作2次：1 4 3 5 2</p>
<p>&hellip;&hellip;</p>
<p>问操作n次之后，得到的序列的所有数之和是多少？</p>
<p><strong>输入格式</strong></p>
<p>三个整数x，y，n，相邻两个数之间用单个空格隔开。0 &lt;= x &lt;= 5，0 &lt;= y &lt;= 5，1 &lt; n &lt;= 10。</p>
<p><strong>输出格式</strong></p>
<p>一个整数，即最终序列中所有数之和。</p>
<p><strong>样例输入</strong></p>
<p>1 2 2</p>
<p><strong>样例输出</strong></p>
<p>15</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; （1）编程思路1。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 像例23一样将操作n次之后的序列生成出来再求和。要生成操作n次之后的序列需要进行二重循环，外循环控制操作次数，内循环通过在前一序列相邻两数间插入和的方式生成新序列。这个序列是不断增长的，第1次操作后有3个数，第2次操作后有5个数，&hellip;，第10次操作后有288个数。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 由于题目求最终序列中所有数之和，因此无需保留中间序列的情况，只需保留最终序列的结果。因此为了方便操作，定义一个二维数组a[2][300]，用滚动数组的方式进行操作。即初始时，a[0][0]=x，a[0][1]=y。然后进行</p>
<p style="margin-left: 30px;">第1次操作，由a[0][0]~a[0][1]得到a[1][0]~a[1][2]；</p>
<p style="margin-left: 30px;">第2次操作，由a[1][0]~a[1][2]得到a[0][0]~a[0][4]；</p>
<p style="margin-left: 30px;">第3次操作，由a[0][0]~a[0][2]得到a[1][0]~a[1][8]；</p>
<p style="margin-left: 30px;">&hellip;&hellip;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 第n次操作，由a[(n-1)%2][0]~a[(n-1)%2][ k-1 ]得到 a[n%2][0]~a[n%2][ k-1+(n-1)*(n-1)]。（k表示上一次操作结束后的元素个数）</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; （2）源程序1。</p>
<p style="margin-left: 30px;">#include &lt;stdio.h&gt;</p>
<p style="margin-left: 30px;">int main()</p>
<p style="margin-left: 30px;">{</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int a[2][300];</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int x,y,n;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; scanf("%d%d%d",&amp;x,&amp;y,&amp;n);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int i,j,k;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; a[0][0]=x;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; a[0][1]=y;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; k=2;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; for(i=1;i&lt;=n;i++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int cnt=0;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (j=0;j&lt;k-1;j++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a[i%2][cnt++]=a[(i-1)%2][j];</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a[i%2][cnt++]=a[(i-1)%2][j]+a[(i-1)%2][j+1];</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a[i%2][cnt++]=a[(i-1)%2][j];</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; k=cnt;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int s=0;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; for (i=0;i&lt;k;i++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s+=a[n%2][i];</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; printf("%d\n",s);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; return 0;</p>
<p style="margin-left: 30px;">}</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; （3）编程思路2。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 由于题目求最终序列中所有数之和，因此我们可以通过找到各次操作后和之间的规律得到结果，而无需生成整个最终序列。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 初始序列为&nbsp;&nbsp; ： x&nbsp;&nbsp; y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 和S[0]为 x+y</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 第1次操作后 ：x， x+y， y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 和s[1]为2x+2y</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 第2次操作后 ：x， 2x+y，x+y，x+2y，y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 和s[2]为5x+5y</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 第3次操作后 ：x，3x+y，2x+y，3x+2y，x+y，2x+3y，x+2y，x+3y，y，和s[3]为14x+14y</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &hellip;&hellip;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 由上面可以推出，若第n次操作后序列和为S[n]，则第n+1次操作后的和S[n+1]一定为3*S[n]-(x+y)。因为在由第n次操作后序列生成第n+1次操作序列时，除首尾两个元素x和y外，中间每个元素会在新序列中产生3次作用（与前一个元素的和，自身，与后一个元素的和），而首尾两个元素x和y只作用两次，x没有前一个元素，y没有后一个元素。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; （4）源程序2。</p>
<p style="margin-left: 30px;">#include &lt;stdio.h&gt;</p>
<p style="margin-left: 30px;">int main()</p>
<p style="margin-left: 30px;">{</p>
<p style="margin-left: 30px;">&nbsp;&nbsp; int x,y,n,s,i;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp; scanf("%d%d%d",&amp;x,&amp;y,&amp;n);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp; s=x+y;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp; for (i=1;i&lt;=n;i++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s=3*s-(x+y);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp; printf("%d\n",s);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp; return 0;</p>
<p style="margin-left: 30px;">}</p>
<h5><span style="font-size: 16px;">23-2&nbsp; 序列</span></h5>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 本题选自洛谷题库 （https://www.luogu.org/problem/P1732）</p>
<p><strong>题目描述</strong></p>
<p>设有数列A={a1, a2, &hellip;, an}，根据数列A计算数列B={b1, b2, &hellip;, bn}，其中：</p>
<p align="left">&nbsp;&nbsp;<img src="./images/C语言程序设计100例之（23）：数列求和0.png" alt="" />&nbsp;</p>
<p>&nbsp;求数列B的前n项之和。</p>
<p><strong>输入格式</strong></p>
<p>第一行是一个正整数t（0&lt;t&lt;=10），表示测试数据的组数。接下来有t行，每行表示一组测试数据。每行以一个正整数n（0&lt;n&lt;=100 000）开始，表示数列A中元素的个数；然后是n个非负整数，依次表示a1, a2, &hellip;, an的值（0&lt;= ai&lt;=65 536）。</p>
<p><strong>输出格式</strong></p>
<p>对于每组测试数据，输出数列B的所有的元素之和。</p>
<p><strong>输入样例</strong></p>
<p>2</p>
<p>5 1 2 3 4 5</p>
<p>7 2 9 7 4 6 2 6</p>
<p><strong>输出样例</strong></p>
<p>5</p>
<p>14</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; （1）编程思路1。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;对每一个a<sub>i</sub>直接根据规则求b<sub>i</sub>。具体说就是用循环求每一个ai 与它前面各个数的差的最小绝对值。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; （2）源程序1。</p>
<p style="margin-left: 30px;">#include &lt;stdio.h&gt;</p>
<p style="margin-left: 30px;">#include &lt;math.h&gt;</p>
<p style="margin-left: 30px;">int main()</p>
<p style="margin-left: 30px;">{</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int t;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; scanf("%d",&amp;t);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int a[100001];</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; while(t--)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int n;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanf("%d",&amp;n);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i=0;i&lt;n;i++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanf("%d",&amp;a[i]);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int sum=a[0];</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i=1;i&lt;n;i++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int min=abs(a[i]-a[0]);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int j=1;j&lt;=i-1;j++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (abs(a[i]-a[j])&lt;min)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; min=abs(a[i]-a[j]);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum+=min;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d\n",sum);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; return 0;</p>
<p style="margin-left: 30px;">}</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; （3）编程思路2。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 按思路1编写程序后，提交给洛谷OJ，只能得30分。10组测试数据中有7组数据显示&ldquo;TLE&rdquo;超时。因此需要想另外的办法。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 题目中给定0&le;ai&le;65536，这意味着可以定义一个hash数组存储对应数字是否已经出现过，hash[i]=0，表示数i在序列中没出现，hash[i]=1表示数i在序列中出现过。这样，每1个a[i]转化成b[i]时，都在hash表中寻找距离它最近的、已经出现过的数。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 即从当前数字x（表示ai）开始向前（x-i）或向后（x+i）遍历，找到对应hash[x-i]或hash[x+i]为1的值，也就是找到了最近已经出现过的的数字aj。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;（4）源程序2。</p>
<p style="margin-left: 30px;">#include &lt;stdio.h&gt;</p>
<p style="margin-left: 30px;">#include &lt;string.h&gt;</p>
<p style="margin-left: 30px;">int main()</p>
<p style="margin-left: 30px;">{</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int t;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; scanf("%d",&amp;t);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int hash[65537];</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; while(t--)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memset(hash,0,sizeof(hash));</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int n,x;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanf("%d%d",&amp;n,&amp;x);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hash[x]=1;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int sum=x;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int k=2;k&lt;=n;k++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanf("%d",&amp;x);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(int i=0;;i++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (x-i&gt;=0)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (hash[x-i])</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum+=i;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (x+i&lt;=65536)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (hash[x+i])</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum+=i;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hash[x]=1;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d\n",sum);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; return 0;</p>
<p style="margin-left: 30px;">}</p>
<h5><span style="font-size: 16px;">23-3&nbsp; 子序列的和求和</span></h5>
<p><strong>问题描述</strong></p>
<p>给定一个正整数数列，求该数列中所有连续子序列和的和。例如，给定数列1,2,3，该数列中连续子序列有：[1], [2], [3], [1, 2], [2, 3]和[1, 2, 3]，这些连续子序列和的和为：1 + 2 + 3 + 3 + 5 + 6 = 20。</p>
<p><strong>输入格式</strong></p>
<p>第1行是一个正整数T，代表测试数据的组数。</p>
<p>每组测试数据包括两行，首行为一个正整数N，表示序列中元素的个数，接着一行给出序列的N个元素。</p>
<p><strong>输出格式</strong></p>
<p>对每组测试用例，输出序列的和模1 000 000 007后的结果。</p>
<p><strong>输入样例</strong></p>
<p>2</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>1 2 3</p>
<p><strong>输出样例</strong></p>
<p>2</p>
<p>20</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; （1）编程思路。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; 同样找规律，规律很明显，数列中每个数ai都被加了i*(N+1-i)次。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;以数列1,2,3为例，第1个数1被加了1*（3+1-1）=3次，第2个数2被加了2*（3+1-2）=4次，第3个数3被加了3*（3+1-3）=3次。所以和=1*3+2*4+3*3=20。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; （2）源程序。</p>
<p style="margin-left: 30px;">#include &lt;stdio.h&gt;</p>
<p style="margin-left: 30px;">#define MOD 1000000007</p>
<p style="margin-left: 30px;">int main()</p>
<p style="margin-left: 30px;">{</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; int t,n;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; scanf("%d",&amp;t);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; while (t--)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanf("%d",&amp;n);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; long long sum=0,x,ai;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i=1;i&lt;=n;i++)</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanf("%lld",&amp;ai);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x=(i*ai)% MOD;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x=(x*(n+1-i)) % MOD;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum=(sum+x) % MOD;</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;printf("%lld\n",sum);</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin-left: 30px;">&nbsp;&nbsp;&nbsp; return 0;</p>
<p style="margin-left: 30px;">}</p>

</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>