<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修童话故事 --- 类模板与函数模板的实例化' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>童话故事 --- 类模板与函数模板的实例化</center></div><div class='banquan'>原文出处:本文由博客园博主micemik提供。<br/>
原文连接:https://www.cnblogs.com/micemik/p/10692103.html</div><br>
    <p>摘要：函数模板的实例化，类模板的实例化，类模板和函数模板的实例化的比较</p>
<div align="center">
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top">
<p>高飞狗：</p>
</td>
<td valign="top" width="473">
<p>Hi，黛丝！好久不见，最近可好?</p>
</td>
</tr>
<tr>
<td valign="top">
<p>黛丝：</p>
</td>
<td valign="top" width="473">
<p>你就别提了，烦得要死！</p>
</td>
</tr>
<tr>
<td valign="top">
<p>高飞狗：</p>
</td>
<td valign="top" width="473">
<p>有什么烦心事，跟我说说，看我能不帮你排忧解难?</p>
</td>
</tr>
<tr>
<td valign="top">
<p>黛丝：</p>
</td>
<td valign="top" width="473">
<p>历经千辛万苦，1个月内学习强国已经突破1000点大关。</p>
</td>
</tr>
<tr>
<td valign="top">
<p>高飞狗：</p>
</td>
<td valign="top" width="473">
<p>进步神速呀！</p>
</td>
</tr>
<tr>
<td valign="top">
<p>黛丝：</p>
</td>
<td valign="top" width="473">
<p>跟自己比，进步神速；可是跟别人比，落后得更神速！你说奇怪不奇怪?</p>
</td>
</tr>
<tr>
<td valign="top">
<p>高飞狗：</p>
</td>
<td valign="top" width="473">
<p>真够奇真够怪的！</p>
</td>
</tr>
<tr>
<td valign="top">
<p>黛丝：</p>
</td>
<td valign="top" width="473">
<p>高飞，你不会没事闲得无聊专程来听我诉苦的吧?</p>
<p>我知道你无事不登八宝殿，有什么事你就直说。</p>
</td>
</tr>
<tr>
<td valign="top">
<p>高飞狗：</p>
</td>
<td valign="top" width="473">
<p>还是黛姐姐您最善解人意哪！</p>
<p>我最近学习也变得非常刻苦，正在研究函数模板和类模板，什么显示explicit实例化，什么隐式implicit实例化，越学越晕，您能给讲解讲解吗?</p>
</td>
</tr>
<tr>
<td valign="top">
<p>黛丝：</p>
</td>
<td valign="top" width="473">
<p>你什么时候也变得勤奋好学起来了?</p>
<p>看你态度这么真诚，我就把我知道的都抖落给你吧。</p>
</td>
</tr>
<tr>
<td valign="top">
<p>黛丝：</p>
</td>
<td valign="top" width="473">
<p>先说函数模板的实例化。</p>
<p>函数模板实例化的方法有两种：隐式实例化和显式(明确)实例化。</p>
<p>&nbsp;</p>
<p>隐式实例化：应用程序调用了一个既未声明又未定义的函数。编译器就到函数模板库中查找同名函数模板，根据被调用函数的入口参数和返回值，确定相匹配的函数模板，并生成一个函数实例。隐式的意思就是应用程序未明确声明或定义函数实例。</p>
<p>&nbsp;</p>
<p>显式(明确)实例化：应用程序明确声明并定义了一个函数模板的实例，如下表所示。</p>
<div align="center">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top">
<p>// 定义一个函数模板，返回两个数的小者&nbsp;&nbsp;&nbsp;</p>
<p>template &nbsp;&nbsp;&nbsp; &lt;typename T&gt;&nbsp;&nbsp;&nbsp;</p>
<p>T min(const T &nbsp;&nbsp;&nbsp; &amp; a, const T &amp; b)</p>
<p>{</p>
<p>&nbsp;&nbsp;return (a &lt; b) ? a : b;&nbsp;&nbsp;&nbsp;</p>
<p>}&nbsp;&nbsp;&nbsp;</p>
</td>
</tr>
<tr>
<td valign="top">显式(明确)实例化
<p>template int &nbsp;&nbsp;&nbsp; min &lt;int&gt; (const int &amp; a, const int &amp; b);&nbsp;&nbsp;&nbsp;</p>
</td>
</tr>
<tr>
<td valign="top">
<p>编译器遇到显式(明确)实例化语句，立即产生一个相应的函数实例&nbsp;&nbsp;&nbsp;</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<div align="center">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td colspan="2" valign="top" width="418"><strong>函数模板显式</strong><strong>(</strong><strong>明确</strong><strong>)</strong><strong>实例化的写法&nbsp;&nbsp;&nbsp;</strong></td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>正确写法</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top" width="391">尖括号部分是关键，C++ Primer V6书中的如下写法是正确的：&nbsp;&nbsp;&nbsp;
<p>template int &nbsp;&nbsp;&nbsp; min &lt;int&gt; (const int &amp; a, &nbsp;&nbsp;&nbsp; const int &amp; b);&nbsp;</p>
</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>错误写法</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top" width="391">
<p>C++ Primer V5书中的如下写法是错误的：</p>
<p>template int &nbsp;&nbsp;&nbsp; min (const int &amp; a, const int &amp; b);&nbsp;&nbsp;&nbsp;</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<div align="center">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td colspan="2" valign="top" width="442">
<p><strong>函数模板显式</strong><strong>(</strong><strong>明确</strong><strong>)</strong><strong>实例化后的调用方法&nbsp;&nbsp;</strong></p>
</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>正确写法</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top" width="387">
<p>尖括号部分是关键：</p>
<p>int c = min &lt;int&gt; (a, b);&nbsp;&nbsp;</p>
</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>错误写法</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top" width="387">没有尖括号部分是错误的&nbsp;&nbsp;&nbsp;
<p>int c = min (a, &nbsp;&nbsp;&nbsp; b);&nbsp;&nbsp;</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<div align="center">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td colspan="2" valign="top" width="454">
<p><strong>取得显式</strong><strong>(</strong><strong>明确</strong><strong>)</strong><strong>实例化函数的地址或指针&nbsp;&nbsp;</strong></p>
</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>正确写法</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top" width="391">
<p>尖括号部分是关键，函数名称就是函数地址。函数实例的名称必须包括类型信息</p>
<p>auto fp = min &nbsp;&nbsp;&nbsp; &lt;int&gt;; 或者auto fp = &amp;min &lt;int&gt;;&nbsp;&nbsp;&nbsp;</p>
</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>错误写法</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top" width="391">
<p>没有尖括号部分是错误的</p>
<p>auto fp = &nbsp;&nbsp;&nbsp; min; 或者auto fp = &amp;min;&nbsp;&nbsp;&nbsp;</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>函数实例的定义和声明</p>
<div align="center">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td colspan="2" valign="top" width="418">
<p><strong>函数实例的定义和声明方法&nbsp;</strong></p>
</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>定义写法</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top" width="391">
<p>template int &nbsp;&nbsp;&nbsp; min &lt;int&gt; (const int &amp; a, &nbsp;&nbsp;&nbsp; const int &amp; b);</p>
</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>声明写法</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top" width="391">&nbsp;关键字extern 表示声明而非定义&nbsp;&nbsp;&nbsp;
<p>extern &nbsp;&nbsp;&nbsp; template int min &lt;int&gt; (const int &amp; a, const int &nbsp;&nbsp;&nbsp; &amp; b);</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<p>编译器见到函数实例的定义，就产生一个函数实例。</p>
<p>编译器见到函数实例的声明，就知道了调用这个函数实例的方式，也知道这个函数已在其它地方被定义，不必产生再一个函数实例。</p>
<p>&nbsp;</p>
<p>再来说类模板的实例化。</p>
<p>类模板只有显式(明确)实例化，无法隐式实例化。比较简单，不再累述。</p>
<p>把类模板和函数模板的实例化做个对比，如下图所示：</p>
<p><!--StartFragment --><img style="width: 376px; height: 244px;" src="./images/童话故事 --- 类模板与函数模板的实例化0.png" alt="" width="552" height="360" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<div align="center">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p align="center"><strong>情形</strong></p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p align="center"><strong>编译器行为</strong></p>
&nbsp;&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>隐式实例化函数模板</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top">
<p>一定将实例代码链接进入可执行程序中，因为函数实例肯定被调用了。</p>
</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>显式实例化函数模板，但未被应用程序调用</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top">
<p>实例代码不会被链接进入可执行程序中。因为未被调用，将其链接进入可执行程序中没有用。</p>
<p>就如同我们定义了一个普通函数，但未被任何其它函数调用，其代码不会被链接进入可执行程序中。</p>
&nbsp;&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>显式实例化函数模板，且被应用程序调用</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top">
<p>一定将实例代码链接进入可执行程序中</p>
</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>实例化类模板，但应用程序未定义相应的对象</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top">
<p>实例代码不会被链接进入可执行程序中。因为未定义相应的对象，将其链接进入可执行程序中没有用。</p>
&nbsp;&nbsp;&nbsp;
<p>就如同我们定义了一个普通类，但未定义相应的对象，其代码不会被链接进可执行程序中。</p>
&nbsp;&nbsp;&nbsp;</td>
</tr>
<tr>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>实例化类模板，且应用程序定义了相应的对象</p>
&nbsp;&nbsp;&nbsp;</td>
<td valign="top">&nbsp;&nbsp;&nbsp;
<p>一定将实例代码链接进入可执行程序中</p>
&nbsp;&nbsp;&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<p>另外，要重点提醒的是，尤其是在MCU上开发C++应用的朋友要注意：若类的对象是局部对象或全局对象，其生命周期贯穿整个应用程序，且其构造函数在main()函数之前被调用执行，所以这些对象的构造函数不可做太多工作。</p>
</td>
</tr>
<tr>
<td valign="top">
<p>高飞：</p>
</td>
<td valign="top" width="473">
<p>亲爱的，你讲得太清楚了，读书效率太低下，读你以分钟胜读十年书！</p>
</td>
</tr>
<tr>
<td valign="top">
<p>黛丝：</p>
</td>
<td valign="top" width="473">
<p>好你个油嘴滑舌！你说要给我排忧解难的，折腾半天，谁给谁排除万难了?</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>