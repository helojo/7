<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修再次认识void' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>再次认识void</center></div><div class='banquan'>原文出处:本文由博客园博主X_大雄提供。<br/>
原文连接:https://www.cnblogs.com/XLX-0327/p/10770968.html</div><br>
    <h1 class="md-end-block md-heading"><span class="md-expand">重新认识void</span></h1>
<p class="md-end-block"><span class="md-tab"> 在初学c/c++时感觉void是一个很不起眼的关键字。因为在c++中我使用的还是比较少的。但是到了Linux中，不论是在内核源码中还是在程序编写的过程中有关void与*的组合随处可见，为了搞清楚、弄明白，具体的原理我写下此博客。</span></p>
<h2 class="md-end-block md-heading"><span>void的定义</span></h2>
<p class="md-end-block"><span class="md-tab"> <span>void简单描述&ldquo;无类型&rdquo;用作限定的作用。例如：</span></span></p>
<pre><code><span><span class="cm-comment">//限制返回值<br /><span><span class="cm-variable-3">void <span class="cm-def">swap(<span class="cm-variable-3">int <span class="cm-operator">&amp;<span class="cm-variable">a, <span class="cm-variable-3">int <span class="cm-operator">&amp;<span class="cm-variable">b)<span class="cm-tab">   <span class="cm-tab">    <span class="cm-comment">//限定函数的返回值为空。<br /><span>{<br /><span> &nbsp; &nbsp;<span class="cm-variable-3">int <span class="cm-variable">temp;<br /><span> &nbsp; &nbsp;<span class="cm-variable">temp <span class="cm-operator">= <span class="cm-variable">a;<br /><span> &nbsp; &nbsp;<span class="cm-variable">a <span class="cm-operator">= <span class="cm-variable">b;<br /><span> &nbsp; &nbsp;<span class="cm-variable">b <span class="cm-operator">= <span class="cm-variable">temp;<br /><span>}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<pre><code><span><span class="cm-comment">//限制参数类型<br /><span><span class="cm-variable-3">int <span class="cm-def">prompt(<span class="cm-variable-3">void)<span class="cm-tab">    <span class="cm-tab">    <span class="cm-comment">//不需要参数传递<br /><span>{<br /><span> &nbsp; &nbsp;<span class="cm-variable">cout<span class="cm-operator">&lt;&lt;<span class="cm-string">"到此结束"<span class="cm-operator">&lt;&lt;<span class="cm-variable">endl;<br /><span> &nbsp; &nbsp;<span class="cm-keyword">return <span class="cm-number">0;<br /><span>}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p class="md-end-block">注意：不要允许使用void去定义变量的类型</p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block">例如：</p>
</li>
</ul>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded md-focus"><span><span class="cm-meta">#include&lt;iostream&gt;<br /><span><span class="cm-keyword">using <span class="cm-keyword">namespace <span class="cm-def">std;<br /><span>​<br /><span><span class="cm-variable-3">int <span class="cm-def">main()<br /><span>{<br /><span><span class="cm-tab">    <span class="cm-variable-3">void <span class="cm-variable">a;<span class="cm-tab"> <span class="cm-tab">    <span class="cm-comment">//会提示错误 &ldquo;不允许使用不完整的类型&rdquo;<br /><span>​<br /><span><span class="cm-tab">    <span class="cm-keyword">return <span class="cm-number">0;<br /><span>}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<h2 class="md-end-block md-heading">void*表示无类型指针</h2>
<p class="md-end-block"><span class="md-tab"> 如果让我描述void*那么可以这样理解，既然是无类型指针那么我们也可以认为任意类型指针，说它是什么类型就是什么类型。为什么这么理解，首先不论是char*,int*,float*等，它们都指向的是一块内存，void*可以指向它们所指向的内存。例如：</span></p>
<pre><code><span><span class="cm-comment">//此程序并无实际意义只是做演示用<br /><span><span class="cm-meta">#include&lt;iostream&gt;<br /><span><span class="cm-keyword">using <span class="cm-keyword">namespace <span class="cm-def">std;<br /><span>​<br /><span><span class="cm-variable-3">int <span class="cm-def">main()<br /><span>{<br /><span><span class="cm-tab">    <span class="cm-variable-3">void* <span class="cm-variable">temp;<span class="cm-tab"> <span class="cm-tab">    <span class="cm-tab">    <span class="cm-tab">    <span class="cm-tab">    <span class="cm-comment">//任意指针类型<br /><span><span class="cm-tab">    <span class="cm-variable-3">int* <span class="cm-variable">p_a <span class="cm-operator">= <span class="cm-keyword">new <span class="cm-variable-3">int;<span class="cm-tab"> <span class="cm-tab">    <span class="cm-tab">    <span class="cm-comment">//int* 类型<br /><span><span class="cm-tab">    <span class="cm-variable-3">char* <span class="cm-variable">p_str <span class="cm-operator">= <span class="cm-string">"hello";<span class="cm-tab">  <span class="cm-tab">    <span class="cm-comment">//char* 类型<br /><span>​<br /><span><span class="cm-tab">    <span class="cm-operator">*<span class="cm-variable">p_a <span class="cm-operator">= <span class="cm-number">10;<br /><span><span class="cm-tab">    <span class="cm-variable">temp <span class="cm-operator">= <span class="cm-variable">p_a;<span class="cm-tab"> <span class="cm-tab">    <span class="cm-tab">    <span class="cm-tab">    <span class="cm-tab">    <span class="cm-comment">//viod* 类型指向 int* 类型<br /><span><span class="cm-tab">    <span class="cm-variable">cout <span class="cm-operator">&lt;&lt; <span class="cm-operator">*(<span class="cm-variable-3">int*)<span class="cm-variable">temp <span class="cm-operator">&lt;&lt; <span class="cm-variable">endl;<br /><span class="cm-tab-wrap-hack"><span class="cm-tab">    <br /><span><span class="cm-tab">    <span class="cm-variable">temp <span class="cm-operator">= <span class="cm-variable">p_str;<span class="cm-tab">   <span class="cm-tab">    <span class="cm-tab">    <span class="cm-tab">    <span class="cm-comment">//void* 类型指向 char* 类型<br /><span><span class="cm-tab">    <span class="cm-variable">cout <span class="cm-operator">&lt;&lt; (<span class="cm-variable-3">char*)<span class="cm-variable">temp <span class="cm-operator">&lt;&lt; <span class="cm-variable">endl;<br /><span class="cm-tab-wrap-hack"><span class="cm-tab">    <br /><span><span class="cm-tab">    <span class="cm-keyword">delete <span class="cm-variable">p_a;<br /><span><span class="cm-tab">    <span class="cm-keyword">return <span class="cm-number">0;<br /><span>}<br /><span><span class="cm-comment">//打印结果为<br /><span><span class="cm-comment">//10<br /><span><span class="cm-comment">//hello<br /><span><span class="cm-comment">//请按任意键继续. . .<br /><span>​</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p class="md-end-block">注意：上述例子中存在类型转换的问题，首先void*指针类型指向其他指针类型时不需要强制转换，但是void*转其他指针类型时需要强制转换，如下：</p>
<pre><code><span><span class="cm-comment">//从上例中摘取的代码<br /><span><span class="cm-variable-3">void* <span class="cm-variable">temp;<span class="cm-tab"> <span class="cm-tab">    <span class="cm-tab">    <span class="cm-tab">    <span class="cm-tab">    <span class="cm-comment">//任意指针类型<br /><span><span class="cm-variable-3">int* <span class="cm-variable">p_a <span class="cm-operator">= <span class="cm-keyword">new <span class="cm-variable-3">int;<span class="cm-tab"> <span class="cm-tab">    <span class="cm-tab">    <span class="cm-comment">//int* 类型<br /><span><span class="cm-operator">*<span class="cm-variable">p_a <span class="cm-operator">= <span class="cm-number">10;<br /><span><span class="cm-variable">temp <span class="cm-operator">= <span class="cm-variable">p_a;<span class="cm-tab"> <span class="cm-tab">    <span class="cm-comment">//viod* 类型指向 int* 类型 不需要强制转换<br /><span><span class="cm-variable">cout <span class="cm-operator">&lt;&lt; <span class="cm-operator">*(<span class="cm-variable-3">int*)<span class="cm-variable">temp <span class="cm-operator">&lt;&lt; <span class="cm-variable">endl;<span class="cm-comment">//需要用(int*)将temp的viod*转换为int*</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p class="md-end-block">看一下Linux.11内核源码中在string.h中的应用：</p>
<pre><code><span><span class="cm-variable-3">void <span class="cm-variable-3">* <span class="cm-def">memcpy(<span class="cm-variable-3">void <span class="cm-variable-3">* <span class="cm-variable">dest,<span class="cm-keyword">const <span class="cm-variable-3">void <span class="cm-variable-3">* <span class="cm-variable">src, <span class="cm-variable-3">int <span class="cm-variable">n)<br /><span>​<br /><span><span class="cm-variable-3">void <span class="cm-variable-3">* <span class="cm-def">memmove(<span class="cm-variable-3">void <span class="cm-variable-3">* <span class="cm-variable">dest,<span class="cm-keyword">const <span class="cm-variable-3">void <span class="cm-variable-3">* <span class="cm-variable">src, <span class="cm-variable-3">int <span class="cm-variable">n)<br /><span><span class="cm-comment">/*在实际应用中也许我们能看见使用这两个函数时，第一个个参数不给char*类型时不会报错，是因为在实际源码中他们时"void*"类型的*/</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>