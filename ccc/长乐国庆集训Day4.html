<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修长乐国庆集训Day4' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>长乐国庆集训Day4</center></div><div class='banquan'>原文出处:本文由博客园博主Ra煞提供。<br/>
原文连接:https://www.cnblogs.com/I-Love-You-520/p/11623277.html</div><br>
    <h2>T1 一道数论神题</h2>
<h3>题目</h3>
<p>【题目描述】</p>
<p>LYK有一张无向图G={V,E}，这张无向图有n个点m条边组成。并且这是一张带权图，只有点权。</p>
<p>LYK想把这个图删干净，它的方法是这样的。每次选择一个点，将它删掉，但删这个点是需要代价的。</p>
<p>假设与这个点相连的还没被删掉的点是u<sub>1</sub>,u<sub>2</sub>,&hellip;,u<sub>k</sub>。LYK将会增加 a[u<sub>1</sub>],a[u<sub>2</sub>],&hellip;,a[u<sub>k</sub>]的疲劳值。</p>
<p>它想将所有点都删掉，并且删完后自己的疲劳值之和最小。你能帮帮它吗？</p>
<p>【输入格式】</p>
<p>第一行两个数n,m表示一张n个点m条边的图。</p>
<p>第二行n个数a<sub>i</sub>表示点权。</p>
<p>接下来m行每行三个数u,v，表示有一条连接u,v的边。数据保证任意两个点之间最多一条边相连，并且不存在自环。</p>
<p>【输出格式】</p>
<p>你需要输出这个最小疲劳值是多少。</p>
<p>【输入样例】</p>
<div class="cnblogs_code">
<pre><code><span style="color: #800080;">4</span> <span style="color: #800080;">3</span>
<span style="color: #800080;">10</span> <span style="color: #800080;">20</span> <span style="color: #800080;">30</span> <span style="color: #800080;">40</span>
<span style="color: #800080;">1</span> <span style="color: #800080;">4</span>
<span style="color: #800080;">1</span> <span style="color: #800080;">2</span>
<span style="color: #800080;">2</span> <span style="color: #800080;">3</span></pre>
</div>
<p>【输出样例】</p>
<div class="cnblogs_code">
<pre><code><span style="color: #800080;">40</span></pre>
</div>
<p>【数据规模】</p>
<p>对于30%的数据n&le;10。</p>
<p>对于60%的数据n,m&le;1000。</p>
<p>对于 100%的数据1&le;n,m,a<sub>i</sub>&le;100000。</p>
<h3>解析</h3>
<p><span style="text-decoration: line-through;">久违的送分题</span></p>
<p>贪心思想，将每个点对与其连接的点的贡献从大到小排序，依次删除即可。</p>
<h3>Code</h3>
<div class="cnblogs_code" onclick="cnblogs_code_show('7a08102e-94c3-44d1-a278-8219c2054327')"><img id="code_img_closed_7a08102e-94c3-44d1-a278-8219c2054327" class="code_img_closed" src="./images/长乐国庆集训Day40.png" alt="" /><img id="code_img_opened_7a08102e-94c3-44d1-a278-8219c2054327" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('7a08102e-94c3-44d1-a278-8219c2054327',event)" src="./images/长乐国庆集训Day41.png" alt="" />
<div id="cnblogs_code_open_7a08102e-94c3-44d1-a278-8219c2054327" class="cnblogs_code_hide">
<pre>#include &lt;algorithm&gt;<span style="color: #000000;">
#include </span>&lt;iostream&gt;<span style="color: #000000;">
#include </span>&lt;cstring&gt;<span style="color: #000000;">
#include </span>&lt;<span style="color: #0000ff;">string</span>&gt;<span style="color: #000000;">
#include </span>&lt;cstdio&gt;<span style="color: #000000;">
#include </span>&lt;vector&gt;<span style="color: #000000;">
#include </span>&lt;cmath&gt;
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;
inline </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> read()
{
    </span><span style="color: #0000ff;">int</span> num=<span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">char</span> ch=<span style="color: #000000;">getchar();
    </span><span style="color: #0000ff;">while</span>(ch&lt;<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span>||ch&gt;<span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span>) ch=<span style="color: #000000;">getchar();
    </span><span style="color: #0000ff;">while</span>(ch&gt;=<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span>&amp;&amp;ch&lt;=<span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    {
        num</span>=(num&lt;&lt;<span style="color: #800080;">1</span>)+(num&lt;&lt;<span style="color: #800080;">3</span>)+ch-<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span><span style="color: #000000;">;
        ch</span>=<span style="color: #000000;">getchar();
    }
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> num;
}
</span><span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> N=<span style="color: #800080;">100100</span><span style="color: #000000;">;
</span><span style="color: #0000ff;">struct</span><span style="color: #000000;"> rec{
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> w,num;
}a[N];
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n,m,b[N];
</span><span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> ans;
</span><span style="color: #0000ff;">bool</span><span style="color: #000000;"> v[N];
vector</span>&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;"> edge[N];
</span><span style="color: #0000ff;">bool</span><span style="color: #000000;"> cmp(rec x,rec y)
{
    </span><span style="color: #0000ff;">return</span> x.w&gt;<span style="color: #000000;">y.w;
}
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
{
    </span><span style="color: #008000;">//</span><span style="color: #008000;">freopen("god.in","r",stdin);
    </span><span style="color: #008000;">//</span><span style="color: #008000;">freopen("god.out","w",stdout);</span>
    memset(v,<span style="color: #0000ff;">false</span>,<span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(v));
    n</span>=read(),m=<span style="color: #000000;">read();
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=n;i++) a[i].w=read(),a[i].num=i,b[i]=<span style="color: #000000;">a[i].w;
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=m;i++<span style="color: #000000;">)
    {
        </span><span style="color: #0000ff;">int</span> x=read(),y=<span style="color: #000000;">read();
        edge[x].push_back(y),edge[y].push_back(x);
    }
    sort(a</span>+<span style="color: #800080;">1</span>,a+n+<span style="color: #800080;">1</span><span style="color: #000000;">,cmp);
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=n;i++<span style="color: #000000;">)
    {
        </span><span style="color: #0000ff;">int</span> x=<span style="color: #000000;">a[i].num;
        v[x]</span>=<span style="color: #0000ff;">true</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j=<span style="color: #800080;">0</span>;j&lt;edge[x].size();j++<span style="color: #000000;">)
            </span><span style="color: #0000ff;">if</span>(!v[edge[x][j]]) ans+=<span style="color: #000000;">b[edge[x][j]];
    }
    cout</span>&lt;&lt;<span style="color: #000000;">ans;
    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>T2 数组异或</h2>
<h3>题目</h3>
<p>【题目描述】</p>
<p align="left">xor&mdash;&mdash;异或，和and与or一样，是一种重要的逻辑运算，他的运算规律是0xor 0=0，1 xor 1=0，1 xor 0=1，0 xor 1=1。</p>
<p align="left">两个整数之间的异或是将两个整数转化成二进制，对他们的每一位分别进行xor操作，例：6(110) xor 13(1101) = 11(1011)</p>
<p align="left">现在我们要介绍一种新的操作&mdash;&mdash;数组异或，将两个相同大小（假设都为n）的数组A、B异或成一个新数组C，则新数组必满足:</p>
<p align="left"><img src="./images/长乐国庆集训Day42.png" alt="" width="271" height="84" /></p>
<p align="left">现在给你数组大小n，和两个数组A,B</p>
<p align="left">求他们的异或数组C</p>
<p align="left">由于最终答案可能过大，你需要对C的每个元素对10<sup>9</sup>+7取模</p>
<p align="left">【输入格式】</p>
<p align="left">一共3行。</p>
<p align="left">第一行一个正整数N。</p>
<p align="left">接下来两行每行N个正整数，表示数组A、B。</p>
<p align="left">【输出格式】</p>
<p align="left">一共1行，N个正整数，表示数组C。</p>
<p align="left">【输入样例】</p>
<div class="cnblogs_code">
<pre><code><span style="color: #800080;">7</span>
<span style="color: #800080;">20670</span> <span style="color: #800080;">1316</span> <span style="color: #800080;">25227</span> <span style="color: #800080;">8316</span> <span style="color: #800080;">21095</span> <span style="color: #800080;">28379</span> <span style="color: #800080;">25235</span>
<span style="color: #800080;">19745</span> <span style="color: #800080;">6535</span> <span style="color: #800080;">14486</span> <span style="color: #800080;">5460</span> <span style="color: #800080;">15690</span> <span style="color: #800080;">1796</span> <span style="color: #800080;">12403</span></pre>
</div>
<p>【输出样例】</p>
<div class="cnblogs_code">
<pre><code><span style="color: #800080;">7583</span> <span style="color: #800080;">52096</span> <span style="color: #800080;">161325</span> <span style="color: #800080;">276944</span> <span style="color: #800080;">453024</span> <span style="color: #800080;">675974</span> <span style="color: #800080;">958287</span></pre>
</div>
<p>【数据规模】</p>
<p align="left">对于50%的数据，N&le;100。</p>
<p align="left">对于全部的数据，N&le;10<sup>5</sup>。</p>
<h3 align="left">解析</h3>
<p>数论不太懂，以下是出题人的题解。</p>
<p><img src="./images/长乐国庆集训Day43.png" alt="" width="381" height="188" /></p>
<h3>Code</h3>
<div class="cnblogs_code" onclick="cnblogs_code_show('062219af-32b4-41cf-92c5-518a502549ef')"><img id="code_img_closed_062219af-32b4-41cf-92c5-518a502549ef" class="code_img_closed" src="./images/长乐国庆集训Day40.png" alt="" /><img id="code_img_opened_062219af-32b4-41cf-92c5-518a502549ef" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('062219af-32b4-41cf-92c5-518a502549ef',event)" src="./images/长乐国庆集训Day41.png" alt="" />
<div id="cnblogs_code_open_062219af-32b4-41cf-92c5-518a502549ef" class="cnblogs_code_hide">
<pre>#include &lt;algorithm&gt;<span style="color: #000000;">
#include </span>&lt;iostream&gt;<span style="color: #000000;">
#include </span>&lt;cstring&gt;<span style="color: #000000;">
#include </span>&lt;<span style="color: #0000ff;">string</span>&gt;<span style="color: #000000;">
#include </span>&lt;cstdio&gt;<span style="color: #000000;">
#include </span>&lt;cmath&gt;
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;
inline </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> read()
{
    </span><span style="color: #0000ff;">int</span> num=<span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">char</span> ch=<span style="color: #000000;">getchar();
    </span><span style="color: #0000ff;">while</span>(ch&lt;<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span>||ch&gt;<span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span>) ch=<span style="color: #000000;">getchar();
    </span><span style="color: #0000ff;">while</span>(ch&gt;=<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span>&amp;&amp;ch&lt;=<span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    {
        num</span>=(num&lt;&lt;<span style="color: #800080;">1</span>)+(num&lt;&lt;<span style="color: #800080;">3</span>)+ch-<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span><span style="color: #000000;">;
        ch</span>=<span style="color: #000000;">getchar();
    }
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> num;
}
</span><span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> N=<span style="color: #800080;">133333</span>,mod=<span style="color: #800080;">1000000007</span><span style="color: #000000;">;
</span><span style="color: #0000ff;">int</span> n,a[N],b[N],aa[<span style="color: #800080;">33</span>][<span style="color: #800080;">2</span>],bb[<span style="color: #800080;">33</span>][<span style="color: #800080;">2</span><span style="color: #000000;">];
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
{
    </span><span style="color: #008000;">//</span><span style="color: #008000;">freopen("xorarray.in","r",stdin);
    </span><span style="color: #008000;">//</span><span style="color: #008000;">freopen("xorarray.out","w",stdout);</span>
    n=<span style="color: #000000;">read();
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=n;i++) a[i]=<span style="color: #000000;">read();
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=n;i++) b[i]=<span style="color: #000000;">read();
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=n;i++<span style="color: #000000;">)
    {
        </span><span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span> c=<span style="color: #800080;">0</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j=<span style="color: #800080;">0</span>;j&lt;=<span style="color: #800080;">30</span>;j++<span style="color: #000000;">)
        {
            aa[j][(a[i]</span>&gt;&gt;j)&amp;<span style="color: #800080;">1</span>]++,bb[j][(b[i]&gt;&gt;j)&amp;<span style="color: #800080;">1</span>]++<span style="color: #000000;">;
            </span><span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span> cc=((<span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span>)aa[j][<span style="color: #800080;">0</span>]*bb[j][<span style="color: #800080;">1</span>]+(<span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span>)aa[j][<span style="color: #800080;">1</span>]*bb[j][<span style="color: #800080;">0</span>])%mod*(<span style="color: #800080;">1</span>&lt;&lt;j)%<span style="color: #000000;">mod;
            c</span>=(c+cc)%<span style="color: #000000;">mod;
        }
        cout</span>&lt;&lt;c&lt;&lt;<span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #000000;">;
    }
    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>T3 侦探游戏</h2>
<h3>题目</h3>
<p>【题目描述】</p>
<p align="left">小W最近沉迷一个侦探游戏，在这个游戏中会不断出现命案，而小W作为主角，需要不断地收集各种关键证据，只有当所有的关键证据都被找到，你才能驳倒所有人错误的判断，找出真正的凶手。</p>
<p align="left">一共有N个关键证据以及M条信息，每条信息如下所示 : 如果你已经掌握了证据i，那么你可以通过k个时间的搜索和推理得到证据j，同样的，如果你掌握了证据j你也可以通过k个时间得到证据i。</p>
<p align="left">游戏开始时玩家通过初步观察现场已经得到了证据1，于此同时，每个玩家在游戏开始阶段时都能获得一个特殊技能来加快游戏进度，增加趣味性。小W 选了一个他以前从来没用过的技能:好运。这是一个被动技能，系统会在游戏开始时选定一对证据(a,b)（a&ne;b）当小W发现其中一个证据的时候，他会很好运地立即获得另外一个证据（不计入时间）。</p>
<p align="left">但是这个技能是完全随机的，小W完全不知道进入游戏后系统会挑选哪一对证据，他希望你能帮助他算出他花在本轮游戏上的时间的期望值，这样他心里能有点B数。</p>
<p align="left">提供的信息保证: i不会等于j，每个k值都互不相同，N个证据都能被得到。</p>
<p align="left">【输入格式】</p>
<p align="left">一共M+1行。</p>
<p align="left">第一行两个正整数N和M，表示证据数量和信息数量。</p>
<p align="left">接下来M行，每行三个数字i,j,k表示一个信息</p>
<p align="left">【输出格式】</p>
<p align="left">共1行，1个整数（期望值是实数，但这里请直接保留2位小数输出）。</p>
<p align="left">【输入样例】</p>
<div class="cnblogs_code">
<pre><code><span style="color: #800080;">3</span> <span style="color: #800080;">3</span>
<span style="color: #800080;">1</span> <span style="color: #800080;">2</span> <span style="color: #800080;">3</span>
<span style="color: #800080;">1</span> <span style="color: #800080;">3</span> <span style="color: #800080;">2</span>
<span style="color: #800080;">2</span> <span style="color: #800080;">3</span> <span style="color: #800080;">5</span></pre>
</div>
<p>【输出样例】</p>
<div class="cnblogs_code">
<pre><code><span style="color: #800080;">2.33</span></pre>
</div>
<p>【数据规模】</p>
<p align="left">对于20%的数据，N&le;100</p>
<p align="left">对于60%的数据，N&le;1000</p>
<p>对于全部的数据，N&le;20000，M&le;10<sup>5</sup>，1&le;k&le;10<sup>6</sup>。</p>
<h3>解析</h3>
<p>一条边权为w的边，如果把MST上所有边权小于w的边加入，且该边加入后联通的点对数增加了K，那么路径上最大边权为w的点对数即为K。</p>
<p>所以可以用一个并查集，把边权从小到大加边，对于边(u,v,w)，答案累加size<sub>u</sub>*size<sub>v</sub>*w，再合并u,v两点所属联通块。(size<sub>i</sub>表示点i所属联通块的大小)。</p>
<h3>Code</h3>
<div class="cnblogs_code" onclick="cnblogs_code_show('f132d1aa-a418-4e77-ba3d-3b6af253a9c3')"><img id="code_img_closed_f132d1aa-a418-4e77-ba3d-3b6af253a9c3" class="code_img_closed" src="./images/长乐国庆集训Day40.png" alt="" /><img id="code_img_opened_f132d1aa-a418-4e77-ba3d-3b6af253a9c3" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('f132d1aa-a418-4e77-ba3d-3b6af253a9c3',event)" src="./images/长乐国庆集训Day41.png" alt="" />
<div id="cnblogs_code_open_f132d1aa-a418-4e77-ba3d-3b6af253a9c3" class="cnblogs_code_hide">
<pre>#include &lt;algorithm&gt;<span style="color: #000000;">
#include </span>&lt;iostream&gt;<span style="color: #000000;">
#include </span>&lt;cstring&gt;<span style="color: #000000;">
#include </span>&lt;<span style="color: #0000ff;">string</span>&gt;<span style="color: #000000;">
#include </span>&lt;cstdio&gt;<span style="color: #000000;">
#include </span>&lt;cmath&gt;
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;
inline </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> read()
{
    </span><span style="color: #0000ff;">int</span> num=<span style="color: #800080;">0</span>,w=<span style="color: #800080;">1</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">char</span> ch=<span style="color: #000000;">getchar();
    </span><span style="color: #0000ff;">while</span>(ch&lt;<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span>||ch&gt;<span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    {
        </span><span style="color: #0000ff;">if</span>(ch==<span style="color: #800000;">'</span><span style="color: #800000;">-</span><span style="color: #800000;">'</span>) w=-<span style="color: #800080;">1</span><span style="color: #000000;">;
        ch</span>=<span style="color: #000000;">getchar();
    }
    </span><span style="color: #0000ff;">while</span>(ch&gt;=<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span>&amp;&amp;ch&lt;=<span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    {
        num</span>=(num&lt;&lt;<span style="color: #800080;">1</span>)+(num&lt;&lt;<span style="color: #800080;">3</span>)+ch-<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span><span style="color: #000000;">;
        ch</span>=<span style="color: #000000;">getchar();
    }
    </span><span style="color: #0000ff;">return</span> num*<span style="color: #000000;">w;
}
</span><span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> N=<span style="color: #800080;">33333</span>,M=<span style="color: #800080;">133333</span><span style="color: #000000;">;
</span><span style="color: #0000ff;">struct</span><span style="color: #000000;"> rec{
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> u,v,d;
}edge[M];
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n,m,fa[N],s[N];
</span><span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> cnt,sum;
</span><span style="color: #0000ff;">bool</span><span style="color: #000000;"> cmp(rec x,rec y)
{
    </span><span style="color: #0000ff;">return</span> x.d&lt;<span style="color: #000000;">y.d;
}
</span><span style="color: #0000ff;">int</span> find(<span style="color: #0000ff;">int</span><span style="color: #000000;"> x)
{
    </span><span style="color: #0000ff;">if</span>(fa[x]==x) <span style="color: #0000ff;">return</span><span style="color: #000000;"> fa[x];
    </span><span style="color: #0000ff;">return</span> fa[x]=<span style="color: #000000;">find(fa[x]);
}
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
{
    n</span>=read(),m=<span style="color: #000000;">read();
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=m;i++) edge[i].u=read(),edge[i].v=read(),edge[i].d=<span style="color: #000000;">read();
    sort(edge</span>+<span style="color: #800080;">1</span>,edge+m+<span style="color: #800080;">1</span><span style="color: #000000;">,cmp);
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=n;i++) fa[i]=i,s[i]=<span style="color: #800080;">1</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=m;i++<span style="color: #000000;">)
    {
        </span><span style="color: #0000ff;">int</span> x=find(edge[i].u),y=<span style="color: #000000;">find(edge[i].v);
        </span><span style="color: #0000ff;">if</span>(x==y) <span style="color: #0000ff;">continue</span><span style="color: #000000;">;
        sum</span>+=edge[i].d,cnt+=(<span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span>)s[x]*s[y]*edge[i].d,s[x]+=s[y],fa[y]=<span style="color: #000000;">x;
    }
    </span><span style="color: #0000ff;">double</span> ans=sum-<span style="color: #800080;">2.0</span>*cnt/n/(n-<span style="color: #800080;">1</span><span style="color: #000000;">);
    printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%.2lf</span><span style="color: #800000;">"</span><span style="color: #000000;">,ans);
    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>T4 天上掉馅饼</h2>
<h3>题目</h3>
<p>【题目描述】</p>
<p>小G进入了一个神奇的世界，在这个世界，天上会掉下一些馅饼。今天，天上会随机掉下k个馅饼。</p>
<p>每次天上掉下馅饼，小 G 可以选择吃或者不吃（必须在下一个馅饼掉 下来之前作出选择，并且现在决定不吃的话以后也不能吃）。</p>
<p>馅饼有n种不同的馅，根据物理定律，天上掉下这n种馅饼的概率相 同且相互独立。然而，每一种馅饼i都有一个前提馅饼集合S<sub>i</sub>。只有当S<sub>i</sub>中 的馅饼都吃过之后，才能吃第i 种馅饼。比如说，韭菜馅馅饼的S中有白菜猪肉馅饼和鲜虾馅饼，那么小G只有在吃过白菜猪肉馅饼和鲜虾馅饼之后，才能吃韭菜馅的馅饼。</p>
<p>同时，每个馅饼还有一个美味值P<sub>i</sub>。今天一天小G的幸福度，等于小G吃到的所有馅饼的美味值之和。注意：Pi 可能是负数。</p>
<p>现在考虑，采用最优策略的前提下，小G这一天期望的幸福度是多少？</p>
<p>【输入格式】</p>
<p>第一行两个正整数k和n，表示馅饼的数量和种类。</p>
<p>以下n行，每行若干个数，描述一种馅饼。其中第一个数代表美味值，随后的整数表示该馅饼的前提馅饼，以0结尾。</p>
<p>【输出格式】</p>
<p>输出一个实数，保留6位小数，即在最优策略下期望的幸福度。</p>
<p>【输入样例】</p>
<div class="cnblogs_code">
<pre><code><span style="color: #800080;">1</span> <span style="color: #800080;">2</span>
<span style="color: #800080;">1</span> <span style="color: #800080;">0</span>
<span style="color: #800080;">2</span> <span style="color: #800080;">0</span></pre>
</div>
<p>【输出样例】</p>
<div class="cnblogs_code">
<pre><code><span style="color: #800080;">1.500000</span></pre>
</div>
<p>【数据规模】</p>
<p>对于20%的数据，所有的馅饼都没有&ldquo;前提馅饼&rdquo;。</p>
<p>对于50%的数据，1&le;k&le;10，1&le;n&le;10。</p>
<p>对于100%的数据，1&le;k &le;100，1&le; n&le;15，美味度为[-10<sup>6</sup>,10<sup>6</sup>]的整数。</p>
<h3>解析</h3>
<p>n只有15，显然状压DP，令f[i][j]表示在第1轮到第i-1轮内是否取过状态为j的最大期望得分。</p>
<p>则状态转移方程为：（1&le;k&le;n）</p>
<ol>
<li>j状态满足吃第k种馅饼的条件，则不吃为f[i+1][j]，吃则为f[i+1][j|(1&lt;&lt;k-1)]+P<sub>k</sub>，取两者最大值累加f[i][j]即可；</li>
<li>j状态不满足吃第k种馅饼的条件，则不能吃，即f[i][j]=f[i+1][j]。</li>
</ol>
<p>至于期望值，虽然很高端的样子，但实际上，由于f[i][j]覆盖了第i轮吃n种馅饼的情况，所以对于每个f[i][j]，均除以n即可。</p>
<p>答案即为f[1][0]。</p>
<h3>Code</h3>
<div class="cnblogs_code" onclick="cnblogs_code_show('dbfaaf2a-8571-4a9b-9817-08543741fbe5')"><img id="code_img_closed_dbfaaf2a-8571-4a9b-9817-08543741fbe5" class="code_img_closed" src="./images/长乐国庆集训Day40.png" alt="" /><img id="code_img_opened_dbfaaf2a-8571-4a9b-9817-08543741fbe5" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('dbfaaf2a-8571-4a9b-9817-08543741fbe5',event)" src="./images/长乐国庆集训Day41.png" alt="" />
<div id="cnblogs_code_open_dbfaaf2a-8571-4a9b-9817-08543741fbe5" class="cnblogs_code_hide">
<pre>#include &lt;algorithm&gt;<span style="color: #000000;">
#include </span>&lt;iostream&gt;<span style="color: #000000;">
#include </span>&lt;cstring&gt;<span style="color: #000000;">
#include </span>&lt;<span style="color: #0000ff;">string</span>&gt;<span style="color: #000000;">
#include </span>&lt;cstdio&gt;<span style="color: #000000;">
#include </span>&lt;cmath&gt;
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;
inline </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> read()
{
    </span><span style="color: #0000ff;">int</span> num=<span style="color: #800080;">0</span>,w=<span style="color: #800080;">1</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">char</span> ch=<span style="color: #000000;">getchar();
    </span><span style="color: #0000ff;">while</span>(ch&lt;<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span>||ch&gt;<span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    {
        </span><span style="color: #0000ff;">if</span>(ch==<span style="color: #800000;">'</span><span style="color: #800000;">-</span><span style="color: #800000;">'</span>) w=-<span style="color: #800080;">1</span><span style="color: #000000;">;
        ch</span>=<span style="color: #000000;">getchar();
    }
    </span><span style="color: #0000ff;">while</span>(ch&gt;=<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span>&amp;&amp;ch&lt;=<span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    {
        num</span>=(num&lt;&lt;<span style="color: #800080;">1</span>)+(num&lt;&lt;<span style="color: #800080;">3</span>)+ch-<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span><span style="color: #000000;">;
        ch</span>=<span style="color: #000000;">getchar();
    }
    </span><span style="color: #0000ff;">return</span> num*<span style="color: #000000;">w;
}
</span><span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> N=<span style="color: #800080;">16</span>,K=<span style="color: #800080;">120</span>,T=<span style="color: #800080;">1</span>&lt;&lt;<span style="color: #800080;">15</span><span style="color: #000000;">;
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> k,n,v[N],d[N];
</span><span style="color: #0000ff;">double</span><span style="color: #000000;"> f[K][T];
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
{
    k</span>=read(),n=<span style="color: #000000;">read();
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=n;i++<span style="color: #000000;">)
    {
        v[i]</span>=<span style="color: #000000;">read();
        </span><span style="color: #0000ff;">int</span> x=<span style="color: #000000;">read();
        </span><span style="color: #0000ff;">while</span>(x) d[i]+=<span style="color: #800080;">1</span>&lt;&lt;(x-<span style="color: #800080;">1</span>),x=<span style="color: #000000;">read();
    }
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=k;i&gt;=<span style="color: #800080;">1</span>;i--<span style="color: #000000;">)
        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j=<span style="color: #800080;">0</span>;j&lt;<span style="color: #800080;">1</span>&lt;&lt;n;j++<span style="color: #000000;">)
        {
            </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> p=<span style="color: #800080;">1</span>;p&lt;=n;p++<span style="color: #000000;">)
                </span><span style="color: #0000ff;">if</span>((j&amp;d[p])==d[p]) f[i][j]+=max(f[i+<span style="color: #800080;">1</span>][j],f[i+<span style="color: #800080;">1</span>][j|(<span style="color: #800080;">1</span>&lt;&lt;(p-<span style="color: #800080;">1</span>))]+<span style="color: #000000;">v[p]);
                </span><span style="color: #0000ff;">else</span> f[i][j]+=f[i+<span style="color: #800080;">1</span><span style="color: #000000;">][j];
            f[i][j]</span>/=<span style="color: #000000;">n;
        }
    printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%.6f</span><span style="color: #800000;">"</span>,f[<span style="color: #800080;">1</span>][<span style="color: #800080;">0</span><span style="color: #000000;">]);
    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>