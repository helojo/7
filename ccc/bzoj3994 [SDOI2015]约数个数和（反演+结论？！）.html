<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修bzoj3994 [SDOI2015]约数个数和（反演+结论？！）' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>bzoj3994 [SDOI2015]约数个数和（反演+结论？！）</center></div><div class='banquan'>原文出处:本文由博客园博主mikufun提供。<br/>
原文连接:https://www.cnblogs.com/mikufun-hzoi-cpp/p/11010814.html</div><br>
    <p><span style="color: #333333;"><strong><span style="font-size: 18px; font-family: 黑体;">这题做的历程堪称惊心动魄</span></strong></span><br /><br /><span style="color: #333333;"><strong><span style="font-size: 18px; font-family: 黑体;">刚刚学了莫比乌斯反演的我高高兴兴的和cbx一起反演式子</span></strong></span><br /><br /><span style="color: #333333;"><strong><span style="font-size: 18px; font-family: 黑体;">期间有突破，有停滞，有否定</span></strong></span><br /><br /><span style="color: #333333;"><strong><span style="font-size: 18px; font-family: 黑体;">然后苟蒻的我背着cbx偷偷打开了题解</span></strong></span><br /><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">看到了</span></strong><img src="./images/bzoj3994 [SDOI2015]约数个数和（反演+结论？！）0.png" alt="" /></span><br /><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">我。。。。。。</span></strong></span><br /><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">去你的有个性质啊<span style="text-decoration: line-through;">（当然还是自己知识储备不足）</span></span></strong></span></p>
<p><span style="font-family: 黑体; font-size: 16px; color: #333333;"><strong><span style="font-size: 18px;">具体证明</span></strong><img src="./images/bzoj3994 [SDOI2015]约数个数和（反演+结论？！）1.png" alt="" /></span><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">（其实当时主要是想的方向偏了，不然这个定理自己也能想出来）</span></strong></span></p>
<p><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">然后就可以愉快的反演了</span></strong></span><br /><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">&nbsp;&Sigma;<sub>（i&isin;[1，n]）</sub>&Sigma;<sub>（j&isin;[1.m]）</sub>d（x,y）</span></strong></span><br /><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">=&Sigma;<sub>(i=1)</sub>&Sigma;<sub>(j=1)</sub>&Sigma;<sub>(x|i)</sub>&Sigma;<sub>(y|j)</sub>[gcd（x,y）==1]</span></strong></span><br /><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">=&Sigma;<sub>(i=1)</sub>&Sigma;<sub>(j=1)</sub>((n/i)*(m/j))&Sigma;<sub>(d|i&amp;&amp;d|j)</sub>&mu;(d)</span></strong></span><br /><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">=&Sigma;<sub>(d=1)</sub>&mu;(d)&Sigma;<sub>(i=1)</sub> (n/(d*i)) &Sigma;<sub>(j=1)</sub>(m/(d*j))</span></strong></span><br /><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">然后我们观察&Sigma;(n/(d*i))</span></strong></span><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">根据性质 (n/(d*i))==((n/d)/i)</span></strong></span><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">我们发现这个东西可以用数论分块O(sqrt(n))预处理，设为f[i]</span></strong></span><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">则原式= &Sigma;(d=1)(&mu;(d)f[n/d]*f[m/d]) </span></strong></span><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">再用数论分块就好了</span></strong></span><br /><span style="color: #333333;"><strong><span style="font-family: 黑体; font-size: 18px;">复杂度O(n*sqrt(n)+T*sqrt(n))</span></strong></span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('5419739d-d98f-4c86-b0e7-2bf9ca8872e6')"><span style="color: #333333;"><img id="code_img_closed_5419739d-d98f-4c86-b0e7-2bf9ca8872e6" class="code_img_closed" src="./images/bzoj3994 [SDOI2015]约数个数和（反演+结论？！）2.png" alt="" /><img id="code_img_opened_5419739d-d98f-4c86-b0e7-2bf9ca8872e6" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('5419739d-d98f-4c86-b0e7-2bf9ca8872e6',event)" src="./images/bzoj3994 [SDOI2015]约数个数和（反演+结论？！）3.png" alt="" /></span>
<div id="cnblogs_code_open_5419739d-d98f-4c86-b0e7-2bf9ca8872e6" class="cnblogs_code_hide">
<pre><code><span style="color: #333333;"> 1 #include&lt;iostream&gt;
 2 #include&lt;cstdio&gt;
 3 #include&lt;cmath&gt;
 4 #define ll long long
 5 using namespace std;
 6 int mu[50100],p[50010],top;ll tot[50100],f[50100];bool v[50010];
 7 int main(){
 8     f[1]=1;tot[1]=1;
 9     for(int i=2;i&lt;=50000;i++){
10         if(!v[i]){
11             p[++top]=i;
12             mu[i]=-1;
13         }
14         for(int j=1;j&lt;=top&amp;&amp;i*p[j]&lt;=50000;j++){
15             if(!(i%p[j])){
16                 v[i*p[j]]=1;
17                 break;
18             } 
19             mu[i*p[j]]=-mu[i];
20             v[i*p[j]]=1;
21         }
22         tot[i]=tot[i-1]+mu[i];
23         int x;
24         for(int j=1;j&lt;=i;j=x+1){
25             x=(i/(i/j));
26             f[i]+=(x-j+1)*(i/j);
27         }
28     }   
29     int j,n,m,t;ll ans;
30     scanf("%d",&amp;t);
31     while(t--){
32         scanf("%d%d",&amp;n,&amp;m);
33         if(n&gt;m) swap(n,m);ans=0;
34         for(int i=1;i&lt;=n;i=j+1){
35             j=min((n/(n/i)),(m/(m/i)));
36             ans+=(tot[j]-tot[i-1])*f[n/i]*f[m/i];
37         }
38         printf("%lld\n",ans);
39     }
40 }</span></pre>
</div>
<span class="cnblogs_code_collapse" style="color: #333333;">第一篇题解博客纪念</span></div>
<p><span style="color: #333333;">&nbsp;</span></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>