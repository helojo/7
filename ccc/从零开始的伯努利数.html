<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修从零开始的伯努利数' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>从零开始的伯努利数</center></div><div class='banquan'>原文出处:本文由博客园博主nosta提供。<br/>
原文连接:https://www.cnblogs.com/nosta/p/11117140.html</div><br>
    <blockquote>
<p>伯努利数的坑太多了，目前正全力整合</p>
<p>基础部分已经填完了。</p>
</blockquote>
<h2 id="伯努利数">伯努利数</h2>
<p>通常情况下指第一类伯努利数<span class="math inline">\(B^-\)</span>，递推式为</p>
<p><span class="math display">\[
B_0=1,\sum_{i=0}^n\binom{n+1}{i}B_i=0(n\ge1)
\]</span></p>
<p>其前若干项为<span class="math inline">\(1,-\frac12,\frac16,0,-\frac1{30},0,\cdots\)</span>，发现对大于1的奇数<span class="math inline">\(n\)</span>伯努利数<span class="math inline">\(B_n=0\)</span>。</p>
<p>与第二类伯努利数<span class="math inline">\(B^+\)</span>的差别在于<span class="math inline">\(B_1^+=\frac12\)</span>，或者说<span class="math inline">\(B^+_i=(-1)^iB^-_i\)</span>，暂不研究。</p>
<h2 id="伯努利数的生成函数">伯努利数的生成函数</h2>
<p>伯努利数<span class="math inline">\(B\)</span>的指数生成函数<br />
<span class="math display">\[
B(x)=\sum_{i=0}\frac{B_i}{i!}x^i=\frac{x}{e^x-1}
\]</span><br />
可以以如下方式推导<br />
<span class="math display">\[
\begin{aligned}
\sum_{i=0}^{n-1}\binom{n}{i}B_i&amp;=0(n\ge2)\\
\sum_{i=0}^{n}\binom{n}{i}B_i&amp;=B_n(n\ge2)\\
\sum_{i=0}^{n}\frac1{(n-i)!}\frac{B_i}{i!}&amp;=\frac{B_n}{n!}(n\ge2)\\
\sum_{n=2}\sum_{i=0}^{n}\frac1{(n-i)!}\frac{B_i}{i!}x^n&amp;=\sum_{n=2}\frac{B_n}{n!}x^n\\
\sum_{n=0}\sum_{i=0}^{n}\frac1{(n-i)!}\frac{B_i}{i!}x^n&amp;=\sum_{n=2}\frac{B_n}{n!}x^n+(\frac{1}{1!}\frac{B_0}{0!}+\frac{1}{0!}\frac{B_1}{1!})x^1+\frac{1}{0!}\frac{B_0}{0!}x^0\\
\sum_{n=0}\sum_{i=0}^{n}\frac1{(n-i)!}\frac{B_i}{i!}x^n&amp;=\sum_{n=0}\frac{B_n}{n!}x^n+x^1\\
B(x)\times e^x&amp;=B(x)+x\Rightarrow B(x)=\frac{x}{e^x-1}
\end{aligned}
\]</span><br />
这明面上给出了一个求出伯努利数列<span class="math inline">\(B\)</span>的前<span class="math inline">\(n\)</span>项的多项式做法，首先钦定<span class="math inline">\(0^0=1\)</span>，<br />
<span class="math display">\[
B(x)=\frac{x}{e^x-1}=\frac{x}{\sum_{i=0}\frac{x^i}{i!}-1}=(\sum_{i=0}\frac{x^i}{(i+1)!})^{-1}
\]</span></p>
<h2 id="伯努利多项式">伯努利多项式</h2>
<p>等幂和函数<br />
<span class="math display">\[
S_m(n)=\sum_{i=1}^ni^m(n,m\ge0)
\]</span><br />
它的多项式表达，即伯努利多项式为<br />
<span class="math display">\[
S_m(n)=\frac1{m+1}\sum_{i=0}^m\binom{m+1}{i}B^+_in^{m+1-i}
\]</span><br />
转换一下，当<span class="math inline">\(n&gt;0\)</span>时，<br />
<span class="math display">\[
\begin{aligned}
\sum_{i=1}^{n-1}i^m=S_m(n)-n^m
&amp;=\frac1{m+1}\sum_{i=0}^m\binom{m+1}{i}B^+_in^{m+1-i}-n^m\\
&amp;=\frac1{m+1}\sum_{i=0,i\not=1}^m\binom{m+1}{i}B^+_in^{m+1-i}+\frac1{m+1}\binom{m+1}{1}\frac12n^m-n^m\\
&amp;=\frac1{m+1}\sum_{i=0,i\not=1}^m\binom{m+1}{i}B^-_in^{m+1-i}-\frac1{m+1}\binom{m+1}{1}\frac12n^m\\
&amp;=\frac1{m+1}\sum_{i=0}^m\binom{m+1}{i}B^-_in^{m+1-i}\\
\sum_{i=1}^{n-1}i^m&amp;=\frac1{m+1}\sum_{i=0}^m\binom{m+1}{i}B^-_in^{m+1-i}
\end{aligned}
\]</span><br />
更常见的是这样一个形式<br />
<span class="math display">\[
\sum_{i=0}^{n-1}i^m=\frac1{m+1}\sum_{i=0}^m\binom{m+1}{i}B^-_in^{m+1-i}
\]</span><br />
怎么得到的？当<span class="math inline">\(m&gt;0\)</span>时它能直接得出；当<span class="math inline">\(m=0\)</span>时式子右边为<span class="math inline">\(n\)</span>，而左边为<span class="math inline">\(n-1+0^0\)</span>，因此只需钦定<span class="math inline">\(0^0=1\)</span>。</p>
<p>考虑证明新的这个式子，左边的生成函数<br />
<span class="math display">\[
\begin{aligned}
F(x)&amp;=\sum_{i=0}\sum_{j=0}^{n-1}j^i\frac{x^i}{i!}=\sum_{j=0}^{n-1}\sum_{i=0}j^i\frac{x^i}{i!}\\
&amp;=\sum_{j=0}^{n-1}e^{jx}=\frac{e^{nx}-1}{e^x-1}\\
&amp;=B(x)\frac{e^{nx}-1}x\\
&amp;=B(x)\frac{\sum_{i=0}\frac{(nx)^i}{i!}-1}x\\
&amp;=B(x)\sum_{i=0}\frac{n^{i+1}}{(i+1)!}x^i\\
&amp;=(\sum_{i=0}\frac{B_i}{i!}x^i)(\frac{n^{i+1}}{(i+1)!}x^i)
\end{aligned}
\]</span></p>
<p>可知<span class="math inline">\([m]F(x)=\sum_{i=0}^m\dfrac{B_i}{i!}\dfrac{n^{m+1-i}}{(m+1-i)!}\)</span>，再乘上指数生成函数中砍去的阶乘<span class="math inline">\(m!\)</span>，恰好是求证等式右边化简后的形式，即得证。</p>
<h2 id="例题-p3711-仓鼠的数学题">例题 P3711 仓鼠的数学题</h2>
<p>现学现用<br />
<span class="math display">\[
\begin{aligned}
\sum_{k=0}^na_k\sum_{i=0}^xi^k
&amp;=\sum_{k=0}^na_k(\frac1{k+1}\sum_{i=0}^k\binom{k+1}{i}B_ix^{k+1-i}+x^k)\\
&amp;=\sum_{k=0}^n\frac{a_k}{k+1}\sum_{i=0}^k\binom{k+1}{i}B_ix^{k+1-i}+\sum_{k=0}^na_kx^k\\
\end{aligned}
\]</span><br />
参考之前推导的过程，对前一块拆开组合数，换枚举<span class="math inline">\(x\)</span>次数来凑卷积<br />
<span class="math display">\[
\sum_{k=0}^n\frac{a_k}{k+1}\sum_{i=0}^k\frac{(k+1)!B_i}{i!(k+1-i)!}x^{k+1-i}
=\sum_{k=0}^na_k(k!)\sum_{i=0}^k\frac{B_i}{i!}\frac{x^{k+1-i}}{(k+1-i)!}\\
=\sum_{k=0}^na_k(k!)\sum_{i=1}^{k+1}\frac{B_{k+1-i}}{(k+1-i)!}\frac{x^i}{i!}
=\sum_{i=1}^{n+1}\sum_{k=i-1}^na_k(k!)\frac{B_{k+1-i}}{(k+1-i)!}\frac{x^i}{i!}\\
=\sum_{i=1}^{n+1}\frac{x^i}{i!}\sum_{k=i-1}^na_k(k!)\frac{B_{k-(i-1)}}{[k-(i-1)]!}
\]</span><br />
将后一个分式的序列反向，就能凑出卷积了。</p>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>