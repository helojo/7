<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修[ bzoj2820] YY的GCD' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>[ bzoj2820] YY的GCD</center></div><div class='banquan'>原文出处:本文由博客园博主DeepinC提供。<br/>
原文连接:https://www.cnblogs.com/hzoi-DeepinC/p/11010256.html</div><br>
    <h1 class="ui header">[ bzoj2820] YY的GCD</h1>
<p><strong>Time Limit : 3000 ms</strong></p>
<p><strong>Description</strong></p>
<blockquote>
<p>神犇YY虐完数论后给傻&times;kAc出了一题给定N, M,求1&lt;=x&lt;=N, 1&lt;=y&lt;=M且gcd(x, y)为质数的(x, y)有多少对kAc这种傻&times;必然不会了，于是向你来请教&hellip;&hellip;</p>
<p>多组输入</p>
</blockquote>
<p><strong>Input</strong></p>
<blockquote>
<p>第一行一个整数T 表述数据组数接下来T行，每行两个正整数，表示N, M</p>
</blockquote>
<p><strong>Output</strong></p>
<blockquote>
<p>T行，每行一个整数表示第i组数据的结果</p>
</blockquote>
<p><strong>Sample Input</strong></p>
<blockquote>
<p><strong><code>2</code></strong></p>
<p><strong><code> 10 10</code></strong></p>
<p><strong><code> 100 100</code></strong></p>
</blockquote>
<p><strong>Sample Output</strong></p>
<blockquote>
<p><strong>30</strong></p>
<p><strong>2791</strong></p>
</blockquote>
<p><strong>Hint</strong></p>
<blockquote>
<p>T = 10000&nbsp;&nbsp;&nbsp; N, M &lt;= 10000000</p>
</blockquote>
<h2>前置知识：</h2>
<p>　　莫比乌斯函数，莫比乌斯反演，欧拉线性筛，数论分块（分段），约数个数</p>
<p>　　大概说一说吧我也是第一次做这种题，会的跳过直接进正题</p>
<p>　　　　莫比乌斯函数：k分解质因数为a<sub>1</sub><sup>b<sub>1</sub></sup>a<sub>2</sub><sup>b<sub>2</sub></sup>...a<sub>m</sub><sup>b<sub>m</sub></sup><sub>&nbsp;</sub> (a<sub>1</sub>,a<sub>2</sub>...a<sub>m</sub>为彼此不同的质数)</p>
<p>　　　　　　　　　　　　若b<sub>1</sub>,b<sub>2</sub>...b<sub>n</sub>中有大于1的项，则&mu;(k)=0</p>
<p>　　　　　　　　　　　　否则&mu;(k)=(-1)<sup>m</sup></p>
<p>&nbsp;</p>
<p>　　　　<strong>莫比乌斯反演：对于已知函数f和g，若满足</strong></p>
<p>　　　　　　　　　　　　　　<em><strong>f(n)=&Sigma; g(d)&nbsp; (其中d是n的约数)</strong></em></p>
<p>　　　　　　　　　　　　<strong>则有<br /></strong>　　　　　　　　　　　　　　<em><strong>g(n)=&Sigma;</strong></em><em><strong>&nbsp;&mu;(d)*f(n/d)&nbsp;(其中d是n的约数)</strong></em></p>
<p><span style="text-decoration: underline;"><em><strong><br /></strong></em></span><em><strong>　　　　　　　　　　　　</strong></em><span style="text-decoration: underline;"><span style="text-decoration: underline;"><strong>常见形式为</strong><em><strong>&Sigma;&nbsp;&mu;(d)= [n]&nbsp;<em><strong>(其中d是n的约数，[n]等同于代码中的（n==1?1:0）)</strong></em></strong></em></span></span></p>
<p><span style="text-decoration: underline;"><span style="text-decoration: underline;"><span style="text-decoration: underline;"><em><strong><em><strong><br /></strong></em></strong></em></span></span></span>　　　　<span style="text-decoration: underline;"><span style="text-decoration: underline;"><span style="text-decoration: underline;">欧拉线性筛：可以在线性复杂度内求出素数，欧拉函数，莫比乌斯函数，详见代码</span></span></span></p>
<p>&nbsp;</p>
<p>　　　　约数个数：n的约数最多只有2&radic;n个。</p>
<p>　　　　　　　　　　对于一个约数a，p/a也是它的约数，除恰好为&radic;n外成对存在。</p>
<p>　　　　　　　　　　如果a&lt;&radic;n，那么p/a&gt;&radic;n。小于&radic;n的显然最多有&radic;n个，那么最多就有&radic;n对即2&radic;n个。</p>
<p>&nbsp;</p>
<p>　　　　<span style="text-decoration: underline;"><strong>数论分块:求和&Sigma;时,随着参数递增而函数值变化频率很低时,直接求每个函数值的出现次数&times;函数值。</strong></span></p>
<p>　　　　　　　　　　如：给出k，求&Sigma;(k/i) (/为整除，i&lt;=k)。</p>
<p>　　　　　　　　　　k=135时，只要68&lt;=i&lt;=135，(k/i)就是1，每次都除显然浪费时间，故求出68与135这两个端点，乘以(k/i)的值1即可。</p>
<p>　　　　　　　　　　　　结合约数个数那一条，这个问题可以从O(n)降低为O(2&radic;n)求解</p>
<h2>正题：</h2>
<p><span style="text-decoration: line-through;">话说这个题目名竟然没有被和谐</span></p>
<p>首先，并不难列出最基础的式子：</p>
<p><img src="./images/[ bzoj2820] YY的GCD0.png" alt="" /></p>
<p>其中p为质数，那么我们可以通过枚举质数来求解，假设n&lt;=m，否则swap。</p>
<p><img src="./images/[ bzoj2820] YY的GCD1.png" alt="" /></p>
<p>将p提出，同时x和y的含义发生变化，变为（是p的几倍），这样x和y的枚举上界就缩小了p倍。</p>
<p><img src="./images/[ bzoj2820] YY的GCD2.png" alt="" /></p>
<p>根据莫比乌斯反演：<span style="text-decoration: underline;"><span style="text-decoration: underline;"><em><strong>&Sigma;&nbsp;&mu;(d)= [n]&nbsp;<em><strong>(其中d是n的约数，[n]等同于代码中的（n==1?1:0）)</strong></em></strong></em></span></span></p>
<p><img src="./images/[ bzoj2820] YY的GCD3.png" alt="" /></p>
<p>x和y能整除gcd(x,y)，而gcd(x,y)能整除d，则x和y都能整除d。</p>
<p><img src="./images/[ bzoj2820] YY的GCD4.png" alt="" /> </p>
<p>改变枚举顺序，先枚举d,那么x，y都是d的倍数，则再次改变x,y的含义(pd的倍数)。</p>
<p>d的范围自然是min(n/p,m/p),这样就可以把&mu;(d)提到外层。</p>
<p><img src="./images/[ bzoj2820] YY的GCD5.png" alt="" /></p>
<p>里面两层的&Sigma;的累加值既然是1，那么就是枚举几次就是几咯(|_ a_|表示a向下取整) </p>
<p><img src="./images/[ bzoj2820] YY的GCD6.png" alt="" /></p>
<p>可以发现&Sigma;后面的式子与p*d关联挺大，所以转换思路枚举k=p*d</p>
<p>(不要问我是怎么想到的，不然我也不会是一个在这里写博客的蒟蒻了)</p>
<p>(从这个式子往下省略下取整符号，我太弱了找不到它！所有除号都表示整除，为了方便区分加上了括号)</p>
<p><img src="./images/[ bzoj2820] YY的GCD7.png" alt="" /></p>
<p>其中(n/k)*(m/k)项与p无关，可以提出来。</p>
<p><img src="./images/[ bzoj2820] YY的GCD8.png" alt="" /></p>
<p>看起来好像化简到头了，为了放松放松脑子，我们先不推公式了，我们来初始化它。</p>
<p> &Sigma;&nbsp;&mu;(k/p)只与k有关而与m，n无关，可以预处理出来，设它是f(k)=&Sigma;&nbsp;&mu;(k/p),其中p是小于等于k的质数。</p>
<p>看起来通过枚举k及k以下的p，复杂度是O(n<sup>2</sup>)级别，难以接受。</p>
<p>转换思路，k不能枚举那就枚举p呗。</p>
<p>通过枚举每个质数p，累加对其他数的贡献，实际复杂度会下降不少。</p>
<p>讲不明白，上代码，还是直接颓代码比较直接痛快。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('56959c92-cbf7-4273-9e29-21bee4638401')"><img id="code_img_closed_56959c92-cbf7-4273-9e29-21bee4638401" class="code_img_closed" src="./images/[ bzoj2820] YY的GCD9.png" alt="" /><img id="code_img_opened_56959c92-cbf7-4273-9e29-21bee4638401" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('56959c92-cbf7-4273-9e29-21bee4638401',event)" src="./images/[ bzoj2820] YY的GCD10.png" alt="" />
<div id="cnblogs_code_open_56959c92-cbf7-4273-9e29-21bee4638401" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;">1</span> <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>,j=prime[<span style="color: #800080;">1</span>];i&lt;=nop;j=prime[++<span style="color: #000000;">i])
</span><span style="color: #008080;">2</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> k=j;k&lt;=maxn;k+=<span style="color: #000000;">j)
</span><span style="color: #008080;">3</span>             f[k]+=miu[k/j];</pre>
</div>
<span class="cnblogs_code_collapse">你要颓代码么？珍重OI节操</span></div>
<p>实际复杂度是O(n log n),可以接受。</p>
<p>&nbsp;那么f函数就搞定了，原算式更简单了。</p>
<p><img src="./images/[ bzoj2820] YY的GCD11.png" alt="" /></p>
<p>&nbsp;这样我们就可以O(n)处理每个询问了，可是面对数据范围还是只有部分分。</p>
<p><span style="text-decoration: line-through;">内心：就这样算了，考场上肯定就码暴力了。</span></p>
<p>不行，不屈的衡中学子我们要追求卓越。</p>
<p>我们可以发现当k趋近于n时，(n/k)与(m/k)两项变化很慢,k增大1时这两项很可能都不变,考虑分段处理。</p>
<p>而每次都在变化的f(k),我们可以用前缀和来求区间和,存在totf里，即totf(k)=&Sigma;f(i)&nbsp;&nbsp; (i&lt;=k)</p>
<p>(n/k)最多2&radic;n段，(m/k)也是这个级别，所以一共最多4&radic;n段。</p>
<p><img src="./images/[ bzoj2820] YY的GCD12.png" alt="" /></p>
<p>每次询问的复杂度为&radic;n级别，可以接受。</p>
<p>呼，完成啦！</p>
<p>最终10个测试点8900ms，比较充裕。</p>
<p>附码量很小（脑量很大）的AC代码。</p>
<p>ps：分段那部分打麻烦了，其实码量可以更小，详见其他神犇</p>
<p>（我这个蒟蒻总不能比他们打的好吧，<span style="text-decoration: line-through;">其实是我故意的</span>）</p>
<p>ps：本人码风自带防抄，对拍等等可以，提交请谨慎。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('dfa8b487-2f3d-48b8-8fc4-984f6fafe3ec')"><img id="code_img_closed_dfa8b487-2f3d-48b8-8fc4-984f6fafe3ec" class="code_img_closed" src="./images/[ bzoj2820] YY的GCD9.png" alt="" /><img id="code_img_opened_dfa8b487-2f3d-48b8-8fc4-984f6fafe3ec" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('dfa8b487-2f3d-48b8-8fc4-984f6fafe3ec',event)" src="./images/[ bzoj2820] YY的GCD10.png" alt="" />
<div id="cnblogs_code_open_dfa8b487-2f3d-48b8-8fc4-984f6fafe3ec" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;"> 1</span> #include&lt;cstdio&gt;
<span style="color: #008080;"> 2</span> #include&lt;cmath&gt;
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn=<span style="color: #000000;">1e7;
</span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">int</span> prime[maxn],notprime[maxn+<span style="color: #800080;">5</span>],nop,n,m,miu[maxn+<span style="color: #800080;">5</span>],t,enda[<span style="color: #800080;">6666</span>],endb[<span style="color: #800080;">6666</span>],ca[<span style="color: #800080;">6666</span>],cb[<span style="color: #800080;">6666</span>],sda,sdb,sqr;<span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span> f[maxn+<span style="color: #800080;">5</span>],qz[maxn+<span style="color: #800080;">5</span><span style="color: #000000;">],ans;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> main(){
</span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=maxn;++i)miu[i]=<span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">2</span>;i&lt;=maxn;++<span style="color: #000000;">i){
</span><span style="color: #008080;"> 9</span>         <span style="color: #0000ff;">if</span>(!notprime[i]){nop++;prime[nop]=i;miu[i]=-<span style="color: #800080;">1</span><span style="color: #000000;">;}
</span><span style="color: #008080;">10</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j=<span style="color: #800080;">1</span>;j&lt;=nop&amp;&amp;i*prime[j]&lt;=maxn;++<span style="color: #000000;">j){
</span><span style="color: #008080;">11</span>             notprime[i*prime[j]]=<span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;">12</span>             <span style="color: #0000ff;">if</span>(i%prime[j]){miu[i*prime[j]]=-miu[i];<span style="color: #0000ff;">continue</span><span style="color: #000000;">;}
</span><span style="color: #008080;">13</span>             miu[i*prime[j]]=<span style="color: #800080;">0</span><span style="color: #000000;">;
</span><span style="color: #008080;">14</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">15</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">16</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">17</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>,j=prime[<span style="color: #800080;">1</span>];i&lt;=nop;j=prime[++<span style="color: #000000;">i])
</span><span style="color: #008080;">18</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> k=j;k&lt;=maxn;k+=<span style="color: #000000;">j)
</span><span style="color: #008080;">19</span>             f[k]+=miu[k/<span style="color: #000000;">j];
</span><span style="color: #008080;">20</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=maxn;++i)qz[i]=qz[i-<span style="color: #800080;">1</span>]+<span style="color: #000000;">f[i];
</span><span style="color: #008080;">21</span>     scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>,&amp;<span style="color: #000000;">t);
</span><span style="color: #008080;">22</span>     <span style="color: #0000ff;">while</span>(t--<span style="color: #000000;">){
</span><span style="color: #008080;">23</span>         scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d%d</span><span style="color: #800000;">"</span>,&amp;m,&amp;n);sda=<span style="color: #800080;">0</span>;sdb=<span style="color: #800080;">0</span>;<span style="color: #0000ff;">if</span>(m&gt;n)sqr=m,m=n,n=<span style="color: #000000;">sqr;
</span><span style="color: #008080;">24</span>         sqr=sqrt(n);ans=<span style="color: #800080;">0</span><span style="color: #000000;">;
</span><span style="color: #008080;">25</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=sqr;++i)ca[++sda]=n/i,enda[sda]=<span style="color: #000000;">i;
</span><span style="color: #008080;">26</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=sqr;i;--i)ca[++sda]=i,enda[sda]=n/<span style="color: #000000;">i;
</span><span style="color: #008080;">27</span>         sqr=<span style="color: #000000;">sqrt(m);
</span><span style="color: #008080;">28</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=sqr;++i)cb[++sdb]=m/i,endb[sdb]=<span style="color: #000000;">i;
</span><span style="color: #008080;">29</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=sqr;i;--i)cb[++sdb]=i,endb[sdb]=m/<span style="color: #000000;">i;
</span><span style="color: #008080;">30</span>         <span style="color: #0000ff;">while</span>(enda[sda-<span style="color: #800080;">1</span>]&gt;=m)sda--;enda[sda]=sqr=<span style="color: #000000;">m;
</span><span style="color: #008080;">31</span>         <span style="color: #0000ff;">while</span>(sda&amp;&amp;<span style="color: #000000;">sdb){
</span><span style="color: #008080;">32</span>             <span style="color: #0000ff;">if</span>(enda[sda-<span style="color: #800080;">1</span>]==endb[sdb-<span style="color: #800080;">1</span>])ans+=(qz[sqr]-qz[endb[sdb-<span style="color: #800080;">1</span>]])*ca[sda]*cb[sdb],sqr=endb[sdb-<span style="color: #800080;">1</span>],sdb--,sda--<span style="color: #000000;">;
</span><span style="color: #008080;">33</span>             <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(enda[sda-<span style="color: #800080;">1</span>]&lt;endb[sdb-<span style="color: #800080;">1</span>])ans+=(qz[sqr]-qz[endb[sdb-<span style="color: #800080;">1</span>]])*ca[sda]*cb[sdb],sqr=endb[sdb-<span style="color: #800080;">1</span>],sdb--<span style="color: #000000;">;
</span><span style="color: #008080;">34</span>             <span style="color: #0000ff;">else</span> ans+=(qz[sqr]-qz[enda[sda-<span style="color: #800080;">1</span>]])*ca[sda]*cb[sdb],sqr=enda[sda-<span style="color: #800080;">1</span>],sda--<span style="color: #000000;">;
</span><span style="color: #008080;">35</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">36</span>         printf(<span style="color: #800000;">"</span><span style="color: #800000;">%lld\n</span><span style="color: #800000;">"</span><span style="color: #000000;">,ans);
</span><span style="color: #008080;">37</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">38</span> }</pre>
</div>
<span class="cnblogs_code_collapse">码风预警/一级戒备</span></div>
<p>&nbsp;update 6/13:依据Dybala_zdy大神的优化.</p>
<p>先读入全部询问，根据其最大值确定线性筛等预处理的范围，优化至5700ms。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('73be3907-3668-4787-bdc4-30d52a4149e1')"><img id="code_img_closed_73be3907-3668-4787-bdc4-30d52a4149e1" class="code_img_closed" src="./images/[ bzoj2820] YY的GCD9.png" alt="" /><img id="code_img_opened_73be3907-3668-4787-bdc4-30d52a4149e1" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('73be3907-3668-4787-bdc4-30d52a4149e1',event)" src="./images/[ bzoj2820] YY的GCD10.png" alt="" />
<div id="cnblogs_code_open_73be3907-3668-4787-bdc4-30d52a4149e1" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;"> 1</span> #include&lt;cstdio&gt;
<span style="color: #008080;"> 2</span> #include&lt;cmath&gt;
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">#define</span> maxnnn 10000000
<span style="color: #008080;"> 5</span> inline <span style="color: #0000ff;">int</span> max(<span style="color: #0000ff;">int</span> a,<span style="color: #0000ff;">int</span> b){<span style="color: #0000ff;">return</span> a&gt;b?<span style="color: #000000;">a:b;}
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">int</span> maxn=<span style="color: #800080;">0</span>,tm[<span style="color: #800080;">10005</span>],tn[<span style="color: #800080;">10005</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">int</span> prime[maxnnn],notprime[maxnnn+<span style="color: #800080;">5</span>],nop,n,m,miu[maxnnn+<span style="color: #800080;">5</span>],t,enda[<span style="color: #800080;">6666</span>],endb[<span style="color: #800080;">6666</span>],ca[<span style="color: #800080;">6666</span>],cb[<span style="color: #800080;">6666</span>],sda,sdb,sqr;<span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span> f[maxnnn+<span style="color: #800080;">5</span>],qz[maxnnn+<span style="color: #800080;">5</span><span style="color: #000000;">],ans;
</span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">int</span> main(){scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>,&amp;<span style="color: #000000;">t);
</span><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=t;++<span style="color: #000000;">i){
</span><span style="color: #008080;">10</span>         scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d%d</span><span style="color: #800000;">"</span>,&amp;tm[i],&amp;<span style="color: #000000;">tn[i]);
</span><span style="color: #008080;">11</span>         maxn=<span style="color: #000000;">max(maxn,max(tm[i],tn[i]));
</span><span style="color: #008080;">12</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">13</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=maxn;++i)miu[i]=<span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;">14</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">2</span>;i&lt;=maxn;++<span style="color: #000000;">i){
</span><span style="color: #008080;">15</span>         <span style="color: #0000ff;">if</span>(!notprime[i]){nop++;prime[nop]=i;miu[i]=-<span style="color: #800080;">1</span><span style="color: #000000;">;}
</span><span style="color: #008080;">16</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j=<span style="color: #800080;">1</span>;j&lt;=nop&amp;&amp;i*prime[j]&lt;=maxn;++<span style="color: #000000;">j){
</span><span style="color: #008080;">17</span>             notprime[i*prime[j]]=<span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;">18</span>             <span style="color: #0000ff;">if</span>(i%prime[j]){miu[i*prime[j]]=-miu[i];<span style="color: #0000ff;">continue</span><span style="color: #000000;">;}
</span><span style="color: #008080;">19</span>             miu[i*prime[j]]=<span style="color: #800080;">0</span><span style="color: #000000;">;
</span><span style="color: #008080;">20</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">21</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">22</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">23</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>,j=prime[<span style="color: #800080;">1</span>];i&lt;=nop;j=prime[++<span style="color: #000000;">i])
</span><span style="color: #008080;">24</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> k=j;k&lt;=maxn;k+=<span style="color: #000000;">j)
</span><span style="color: #008080;">25</span>             f[k]+=miu[k/<span style="color: #000000;">j];
</span><span style="color: #008080;">26</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=maxn;++i)qz[i]=qz[i-<span style="color: #800080;">1</span>]+<span style="color: #000000;">f[i];
</span><span style="color: #008080;">27</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> ii=<span style="color: #800080;">1</span>;ii&lt;=t;++<span style="color: #000000;">ii){
</span><span style="color: #008080;">28</span>         m=tm[ii];n=tn[ii];sda=<span style="color: #800080;">0</span>;sdb=<span style="color: #800080;">0</span>;<span style="color: #0000ff;">if</span>(m&gt;n)sqr=m,m=n,n=<span style="color: #000000;">sqr;
</span><span style="color: #008080;">29</span>         sqr=sqrt(n);ans=<span style="color: #800080;">0</span><span style="color: #000000;">;
</span><span style="color: #008080;">30</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=sqr;++i)ca[++sda]=n/i,enda[sda]=<span style="color: #000000;">i;
</span><span style="color: #008080;">31</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=sqr;i;--i)ca[++sda]=i,enda[sda]=n/<span style="color: #000000;">i;
</span><span style="color: #008080;">32</span>         sqr=<span style="color: #000000;">sqrt(m);
</span><span style="color: #008080;">33</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">1</span>;i&lt;=sqr;++i)cb[++sdb]=m/i,endb[sdb]=<span style="color: #000000;">i;
</span><span style="color: #008080;">34</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=sqr;i;--i)cb[++sdb]=i,endb[sdb]=m/<span style="color: #000000;">i;
</span><span style="color: #008080;">35</span>         <span style="color: #0000ff;">while</span>(enda[sda-<span style="color: #800080;">1</span>]&gt;=m)sda--;enda[sda]=sqr=<span style="color: #000000;">m;
</span><span style="color: #008080;">36</span>         <span style="color: #0000ff;">while</span>(sda&amp;&amp;<span style="color: #000000;">sdb){
</span><span style="color: #008080;">37</span>             <span style="color: #0000ff;">if</span>(enda[sda-<span style="color: #800080;">1</span>]==endb[sdb-<span style="color: #800080;">1</span>])ans+=(qz[sqr]-qz[endb[sdb-<span style="color: #800080;">1</span>]])*ca[sda]*cb[sdb],sqr=endb[sdb-<span style="color: #800080;">1</span>],sdb--,sda--<span style="color: #000000;">;
</span><span style="color: #008080;">38</span>             <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(enda[sda-<span style="color: #800080;">1</span>]&lt;endb[sdb-<span style="color: #800080;">1</span>])ans+=(qz[sqr]-qz[endb[sdb-<span style="color: #800080;">1</span>]])*ca[sda]*cb[sdb],sqr=endb[sdb-<span style="color: #800080;">1</span>],sdb--<span style="color: #000000;">;
</span><span style="color: #008080;">39</span>             <span style="color: #0000ff;">else</span> ans+=(qz[sqr]-qz[enda[sda-<span style="color: #800080;">1</span>]])*ca[sda]*cb[sdb],sqr=enda[sda-<span style="color: #800080;">1</span>],sda--<span style="color: #000000;">;
</span><span style="color: #008080;">40</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">41</span>         printf(<span style="color: #800000;">"</span><span style="color: #800000;">%lld\n</span><span style="color: #800000;">"</span><span style="color: #000000;">,ans);
</span><span style="color: #008080;">42</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">43</span> }</pre>
</div>
<span class="cnblogs_code_collapse">Update 6/13</span></div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>