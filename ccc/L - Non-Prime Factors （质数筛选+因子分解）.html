<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修L - Non-Prime Factors （质数筛选+因子分解）' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>L - Non-Prime Factors （质数筛选+因子分解）</center></div><div class='banquan'>原文出处:本文由博客园博主丿不落良辰提供。<br/>
原文连接:https://www.cnblogs.com/Remilia-Scarlet/p/10733424.html</div><br>
    <p>In many programming competitions, we are asked to find (or count the number of) Prime Factors of an integer&nbsp;<span class="tex2jax_process"><span id="MathJax-Element-1-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;"><span id="MathJax-Span-1" class="math"><span id="MathJax-Span-2" class="mrow"><span id="MathJax-Span-3" class="mi">i</span></span></span><span class="MJX_Assistive_MathML">. This is boring. This time, let&rsquo;s count the number of Non-Prime Factors of an integer&nbsp;<span class="tex2jax_process"><span id="MathJax-Element-2-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;"><span id="MathJax-Span-4" class="math"><span id="MathJax-Span-5" class="mrow"><span id="MathJax-Span-6" class="mi"></span></span></span><span class="MJX_Assistive_MathML">i, denoted as&nbsp;<tt class="ttfamily">NPF(i)</tt>.</span></span></span></span></span></span></p>
<p>For example, integer&nbsp;<span class="tex2jax_process"><span id="MathJax-Element-3-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/math&gt;"><span id="MathJax-Span-7" class="math"><span id="MathJax-Span-8" class="mrow"><span id="MathJax-Span-9" class="mn">100</span></span></span><span class="MJX_Assistive_MathML">&nbsp;has the following nine factors:&nbsp;<span class="tex2jax_process"><span id="MathJax-Element-4-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;munder&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x005F;&lt;/mo&gt;&lt;/munder&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;munder&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;&amp;#x005F;&lt;/mo&gt;&lt;/munder&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;25&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;"><span id="MathJax-Span-10" class="math"><span id="MathJax-Span-11" class="mrow"><span id="MathJax-Span-12" class="mo">{<span id="MathJax-Span-13" class="mn">1<span id="MathJax-Span-14" class="mo">,<span id="MathJax-Span-15" class="munderover"><span id="MathJax-Span-16" class="mn"><span style="text-decoration: underline;">2</span><span id="MathJax-Span-17" class="mo"><span id="MathJax-Span-18" class="mo">,<span id="MathJax-Span-19" class="mn">4<span id="MathJax-Span-20" class="mo">,<span id="MathJax-Span-21" class="munderover"><span id="MathJax-Span-22" class="mn"><span style="text-decoration: underline;">5</span><span id="MathJax-Span-23" class="mo"><span id="MathJax-Span-24" class="mo">,<span id="MathJax-Span-25" class="mn">10<span id="MathJax-Span-26" class="mo">,<span id="MathJax-Span-27" class="mn">20<span id="MathJax-Span-28" class="mo">,<span id="MathJax-Span-29" class="mn">25<span id="MathJax-Span-30" class="mo">,<span id="MathJax-Span-31" class="mn">50<span id="MathJax-Span-32" class="mo">,<span id="MathJax-Span-33" class="mn">100<span id="MathJax-Span-34" class="mo">}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML">. The two which are underlined are prime factors of&nbsp;<span class="tex2jax_process"><span id="MathJax-Element-5-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/math&gt;"><span id="MathJax-Span-35" class="math"><span id="MathJax-Span-36" class="mrow"><span id="MathJax-Span-37" class="mn">100</span></span></span><span class="MJX_Assistive_MathML">&nbsp;and the rest are non-prime factors. Therefore,&nbsp;<tt class="ttfamily">NPF(100)</tt>&nbsp;=&nbsp;<span class="tex2jax_process"><span id="MathJax-Element-6-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/math&gt;"><span class="MJX_Assistive_MathML">7.</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2>Input</h2>
<p>The first line contains an integer&nbsp;<span class="tex2jax_process"><span id="MathJax-Element-7-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;"><span id="MathJax-Span-41" class="math"><span id="MathJax-Span-42" class="mrow"><span id="MathJax-Span-43" class="mi">Q</span></span></span><span class="MJX_Assistive_MathML">&nbsp;(<span class="tex2jax_process"><span id="MathJax-Element-8-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;"><span id="MathJax-Span-44" class="math"><span id="MathJax-Span-45" class="mrow"><span id="MathJax-Span-46" class="mn">1<span id="MathJax-Span-47" class="mo">&le;<span id="MathJax-Span-48" class="mi">Q<span id="MathJax-Span-49" class="mo">&le;<span id="MathJax-Span-50" class="mn">3<span id="MathJax-Span-51" class="mo">&sdot;<span id="MathJax-Span-52" class="msubsup"><span id="MathJax-Span-53" class="mn">10^6<span id="MathJax-Span-54" class="mn"></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML">) denoting the number of queries. Each of the next&nbsp;<span class="tex2jax_process"><span id="MathJax-Element-9-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;"><span id="MathJax-Span-55" class="math"><span id="MathJax-Span-56" class="mrow"><span id="MathJax-Span-57" class="mi">Q</span></span></span><span class="MJX_Assistive_MathML">&nbsp;lines contains one integer&nbsp;<span class="tex2jax_process"><span id="MathJax-Element-10-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;"><span id="MathJax-Span-58" class="math"><span id="MathJax-Span-59" class="mrow"><span id="MathJax-Span-60" class="mi">i&nbsp;</span></span></span><span class="MJX_Assistive_MathML">(<span class="tex2jax_process"><span id="MathJax-Element-11-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;"><span id="MathJax-Span-61" class="math"><span id="MathJax-Span-62" class="mrow"><span id="MathJax-Span-63" class="mn">2<span id="MathJax-Span-64" class="mo">&le;<span id="MathJax-Span-65" class="mi">i<span id="MathJax-Span-66" class="mo">&le;<span id="MathJax-Span-67" class="mn">2<span id="MathJax-Span-68" class="mo">&sdot;<span id="MathJax-Span-69" class="msubsup"><span id="MathJax-Span-70" class="mn">10^6<span id="MathJax-Span-71" class="mn"></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML">).</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2>Output</h2>
<p>For each query&nbsp;<span class="tex2jax_process"><span id="MathJax-Element-12-Frame" class="MathJax" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;"><span id="MathJax-Span-72" class="math"><span id="MathJax-Span-73" class="mrow"><span id="MathJax-Span-74" class="mi"></span></span></span><span class="MJX_Assistive_MathML">i, print the value of&nbsp;<tt class="ttfamily">NPF(i)</tt>.</span></span></span></p>
<h2>Warning</h2>
<p><strong class="bfseries">The I/O files are large. Please use fast I/O methods.</strong></p>
<table class="sample" summary="sample data">
<tbody>
<tr><th>Sample Input 1</th><th>Sample Output 1</th></tr>
<tr>
<td>
<pre>4
100
13
12
2018
</pre>
</td>
<td>
<pre>7
1
4
2</pre>
</td>
</tr>
</tbody>
</table>
<p>题目大意：第一行给一个Q，代表Q次查询，接下来Q行，每行一个整数i，求NPF（i）</p>
<p>　　　　拿样例100来说，100的因子有（1,2,4,5,10,20,25,50,100）共9个，其中2和5是质数（一个大于1的自然数，除了1和它本身外，不能被其他自然数整除），应去掉，剩下7个。</p>
<p>　　　　所以NPF（100）= 7</p>
<p>　　　　拿样例13来说，13的因子有（1,13）共2个，其中13是质数，去掉后，剩下1个。</p>
<p>　　　　所以NPF（13）= 1</p>
<p>&nbsp;</p>
<p>解题思路：1.先预处理出1-2*10^6的质数。可以用eratosthenes筛法，时间复杂度O(NloglogN)（某位网友说的）</p>
<p>　　　　　2.<strong>预处理答案，先看代码：</strong></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i &lt;= <span style="color: #800080;">2000000</span>; ++<span style="color: #000000;">i){
        </span><span style="color: #0000ff;">int</span> rt = <span style="color: #800080;">2000000</span>/<span style="color: #000000;">i;
        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j = i; j &lt;= rt; ++<span style="color: #000000;">j){
            </span><span style="color: #0000ff;">if</span>(vis[i]){<span style="color: #008000;">//</span><span style="color: #008000;">非质数 </span>
                ++ans[i*<span style="color: #000000;">j];
            }
            </span><span style="color: #0000ff;">if</span>(vis[j] &amp;&amp; i!=<span style="color: #000000;">j){
                </span>++ans[i*<span style="color: #000000;">j];
            }
        }
    }</span></pre>
</div>
<p>　　第一个for循环，表示1到2*10^6的数。</p>
<p>　　第二个for循环，对于当前的数i，对 i 到 i*rt 进行处理</p>
<p>　　举个栗子，<strong>对于100来说</strong>，ans【100】初始化是0</p>
<p>　　<strong>第一个循环到1时</strong>，</p>
<p>　　　　在第二个循环中：<strong>判断1是非质数</strong>，<strong>第一个if</strong>中必然会有1*100=100，即ans【100】++；（100&lt;rt,必然出现）</p>
<p>　　　　　　　　　　　<strong>　第二个if</strong>中会出现j=100，<strong>100是非质数</strong>，又100*1=100，即ans【100】++；</p>
<p>　　tip：当i=100时，j 从100开始累加而且 j 不会回溯，所以100=1*100这一种分解方法会在i=1的时候处理出来</p>
<p>　　　　即ans【100】+=2；</p>
<p>　　<strong>第一个循环到2时</strong>：</p>
<p>　　　　在第二个循环中：<strong>第一个if&nbsp;</strong> 判断2是质数，跳过（相当于把2这个因子剔除了，即没有加入答案中）</p>
<p>　　　　　　　　　　　<strong>　第二个if&nbsp; </strong>j=50时,50是非质数，又50*2=100，所以ans【100】++；</p>
<p>　　<strong>第一个循环到4时</strong>：</p>
<p>　　　　在第二个循环中：<strong>第一个if&nbsp;</strong>&nbsp;判断4是非质数，4*25=100,ans【100】++；</p>
<p>　　　　　　　　　　　<strong>　第二个if&nbsp;&nbsp;</strong>j=25时,25是非质数，25*4=100，所以ans【100】++；</p>
<p>　　<strong>第一个循环到5时</strong>：</p>
<p>　　　　在第二个循环中：<strong>第一个if&nbsp;</strong>&nbsp;判断5是质数，跳过，</p>
<p>　　　　　　　　　　　<strong>　第二个if&nbsp;&nbsp;</strong>j=20时,20是非质数，20*5=100，所以ans【100】++；</p>
<p>　　<strong>第一个循环到10时</strong>：</p>
<p>　　　　在第二个循环中：<strong>第一个if&nbsp;</strong>&nbsp;判断10是非质数，10*10=100，ans【100】++；</p>
<p>　　　　　　　　　　　<strong>　第二个if&nbsp;&nbsp;</strong>j=10时,10是非质数，但是i=j，跳过（相同因子处理一次即可，在第一个if处理了）</p>
<p>　　<strong>第一个循环到20时</strong>：20*5=100，但是5不会出现，因为j是从20开始不断累加，ans【100】已经处理结束了，从上面分析可以看出ans【100】=7；</p>
<p>　　类似的，每个答案都可以在这2个循环中处理出来。</p>
<p>　　时间上：当i=1来说，rt=2*10^6，j会从1加到2*10^6</p>
<p>　　　　　　当i=2，rt=10^6，&nbsp; &nbsp;j会从2加到10^6；</p>
<p>　　　　　　......　　</p>
<p>　　　　　　当i=10，rt=2*10^5，j会从10加到2*10^5（此时数量级已经降了一级）</p>
<p>　　　　　　...</p>
<p>　　　　　　当i=100，rt=2*10^4，j会从1加到2*10^4</p>
<p>　　　　　　....</p>
<p>　　　　　　当i=1000，rt=2*10^3，j会从1000加到2000（共1000次）</p>
<p>　　　　　　.....</p>
<p>　　　　　　当i=sqrt（2*10^6） rt=i，第二层循环直接跳过，后面一样，都是1次</p>
<p>把它们加起来，大概也就10^7左右（目测估计法算的）</p>
<p>预处理10^6左右，Q个问题3*10^6，加起来数量级也在10^7</p>
<p>某位大佬说10^7的数量级一般都能在1s跑完，要看测评机</p>
<p>一开始我是对每次枚举每个数的因数（1-sqrt（n）），然后想办法优化，结果都是超时....（(╯‵□&prime;)╯︵┻━┻）</p>
<p><strong>启示：优化的时候想想办法让回溯的次数少一点。</strong></p>
<p><strong>AC代码：</strong></p>
<div class="cnblogs_code">
<pre>#include &lt;iostream&gt;<span style="color: #000000;">
#include </span>&lt;stdio.h&gt;<span style="color: #000000;">
#include </span>&lt;cmath&gt;
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;
</span><span style="color: #0000ff;">bool</span> vis[<span style="color: #800080;">2000005</span><span style="color: #000000;">];
</span><span style="color: #0000ff;">int</span> ans[<span style="color: #800080;">2000005</span><span style="color: #000000;">];
</span><span style="color: #0000ff;">void</span><span style="color: #000000;"> init()
{
    </span><span style="color: #008000;">//</span><span style="color: #008000;">开始筛，vis=1表示该数不是质数</span>
    vis[<span style="color: #800080;">1</span>]=<span style="color: #800080;">1</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">int</span> m=sqrt(<span style="color: #800080;">2000002</span>+<span style="color: #800080;">0.5</span><span style="color: #000000;">);
    </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=<span style="color: #800080;">2</span>;i&lt;=m;++<span style="color: #000000;">i) 
    </span><span style="color: #0000ff;">if</span>(!vis[i]) <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j=i*i;j&lt;=<span style="color: #800080;">2000002</span>;j+=i) vis[j]=<span style="color: #800080;">1</span><span style="color: #000000;">;
     </span><span style="color: #008000;">//</span><span style="color: #008000;">筛选结束    </span>
    <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i &lt;= <span style="color: #800080;">2000000</span>; ++<span style="color: #000000;">i){
        </span><span style="color: #0000ff;">int</span> rt = <span style="color: #800080;">2000000</span>/<span style="color: #000000;">i;
        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j = i; j &lt;= rt; ++<span style="color: #000000;">j){
            </span><span style="color: #0000ff;">if</span>(vis[i]){<span style="color: #008000;">//</span><span style="color: #008000;">非质数 </span>
                ++ans[i*<span style="color: #000000;">j];
            }
            </span><span style="color: #0000ff;">if</span>(vis[j] &amp;&amp; i!=<span style="color: #000000;">j){
                </span>++ans[i*<span style="color: #000000;">j];
            }
        }
    }
}
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
{
    init();
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> Q;
    scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>,&amp;<span style="color: #000000;">Q);
    </span><span style="color: #0000ff;">while</span>(Q--<span style="color: #000000;">)
    {
        </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n;
        scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>,&amp;<span style="color: #000000;">n);
        printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d\n</span><span style="color: #800000;">"</span><span style="color: #000000;">,ans[n]);
    }
    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>