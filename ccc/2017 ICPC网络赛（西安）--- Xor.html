<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修2017 ICPC网络赛（西安）--- Xor' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>2017 ICPC网络赛（西安）--- Xor</center></div><div class='banquan'>原文出处:本文由博客园博主茶飘香~提供。<br/>
原文连接:https://www.cnblogs.com/chen9510/p/10800247.html</div><br>
    <p><a href="https://nanti.jisuanke.com/t/A1273" target="_blank">题目连接</a></p>
<p>&nbsp;</p>
<p><span style="font-size: 16px;"><strong>Problem</strong></span></p>
<div id="description" class="jsk-margin-top">
<p>There is a tree with&nbsp;<span class="katex"><span class="katex-mathml">n<span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">&nbsp;nodes. For each node, there is an integer value&nbsp;<span class="katex"><span class="katex-mathml">ai<span class="katex-html"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault"><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight"><span class="vlist-s"><span class="vlist-r"><span class="vlist">, (<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord">1<span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault">a<span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i<span class="vlist-s">​<span class="vlist-r"><span class="vlist"><span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord">1<span class="mpunct">,<span class="mspace"><span class="mord">0<span class="mord">0<span class="mord">0<span class="mpunct">,<span class="mspace"><span class="mord">0<span class="mord">0<span class="mord">0<span class="mpunct">,<span class="mspace"><span class="mord">0<span class="mord">0<span class="mord">0&nbsp;for&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord">1<span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord mathdefault">i<span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord mathdefault">n). There is&nbsp;<span class="katex"><span class="katex-mathml">q<span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">&nbsp;queries which are described as follow: </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault"><span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault"><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight"><span class="vlist-s"><span class="vlist-r"><span class="vlist"><span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord"><span class="mspace"><span class="mrel"><span class="mspace"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault"><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight"><span class="vlist-s"><span class="vlist-r"><span class="vlist"><span class="mspace"><span class="mrel"><span class="mspace"><span class="base"><span class="strut"><span class="mord"><span class="mpunct"><span class="mspace"><span class="mord"><span class="mord"><span class="mord"><span class="mpunct"><span class="mspace"><span class="mord"><span class="mord"><span class="mord"><span class="mpunct"><span class="mspace"><span class="mord"><span class="mord"><span class="mord"><span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord"><span class="mspace"><span class="mrel"><span class="mspace"><span class="base"><span class="strut"><span class="mord mathdefault"><span class="mspace"><span class="mrel"><span class="mspace"><span class="base"><span class="strut"><span class="mord mathdefault"><span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">Assume the value on the path from node&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">a&nbsp;to node&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">b&nbsp;is&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault">t<span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0<span class="vlist-s">​<span class="vlist-r"><span class="vlist"><span class="mpunct">,<span class="mspace"><span class="mord"><span class="mord mathdefault">t<span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1<span class="vlist-s">​<span class="vlist-r"><span class="vlist"><span class="mpunct">,<span class="mspace"><span class="minner">⋯<span class="mspace"><span class="mord"><span class="mord mathdefault">t<span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m<span class="vlist-s">​<span class="vlist-r"><span class="vlist">. You are supposed to calculate&nbsp;<span class="katex"><span class="katex-mathml">t0<span class="katex-html"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault"><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="vlist-s"><span class="vlist-r"><span class="vlist">&nbsp;xor&nbsp;<span class="katex"><span class="katex-mathml">tk<span class="katex-html"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault"><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight"><span class="vlist-s"><span class="vlist-r"><span class="vlist">&nbsp;xor&nbsp;<span class="katex"><span class="katex-mathml">t2k<span class="katex-html"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault"><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight"><span class="vlist-s"><span class="vlist-r"><span class="vlist">&nbsp;xor ... xor&nbsp;<span class="katex"><span class="katex-mathml">tpk<span class="katex-html"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault"><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight"><span class="mord mathdefault mtight"><span class="vlist-s"><span class="vlist-r"><span class="vlist">&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mopen">(<span class="mord mathdefault">p<span class="mord mathdefault">k<span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord mathdefault">m<span class="mclose">).</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3>Input Format</h3>
<p>There are multi datasets.&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mopen">(<span class="mop op-symbol small-op">&sum;<span class="mspace"><span class="mord mathdefault">n<span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord">5<span class="mord">0<span class="mpunct">,<span class="mspace"><span class="mord">0<span class="mord">0<span class="mord">0<span class="mpunct">,<span class="mspace"><span class="mop op-symbol small-op">&sum;<span class="mspace"><span class="mord mathdefault">q<span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord">5<span class="mord">0<span class="mord">0<span class="mpunct">,<span class="mspace"><span class="mord">0<span class="mord">0<span class="mord">0<span class="mclose">).</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>For each dataset: In the first&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">n<span class="mspace"><span class="mbin">&minus;<span class="mspace"><span class="base"><span class="strut"><span class="mord">1&nbsp;lines, there are two integers&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">u<span class="mpunct">,<span class="mspace"><span class="mord mathdefault">v, indicates there is an edge connect node&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">uand node&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">v.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>In the next&nbsp;<span class="katex"><span class="katex-mathml">n<span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">n&nbsp;lines, There is an integer&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault">a<span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i<span class="vlist-s">​<span class="vlist-r"><span class="vlist">&nbsp;(<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord">1<span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord"><span class="mord mathdefault">a<span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="pstrut"><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i<span class="vlist-s">​<span class="vlist-r"><span class="vlist"><span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord">1<span class="mpunct">,<span class="mspace"><span class="mord">0<span class="mord">0<span class="mord">0<span class="mpunct">,<span class="mspace"><span class="mord">0<span class="mord">0<span class="mord">0<span class="mpunct">,<span class="mspace"><span class="mord">0<span class="mord">0<span class="mord">0).</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>In the next&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">q&nbsp;lines, There is three integers&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">a<span class="mpunct">,<span class="mspace"><span class="mord mathdefault">b&nbsp;and&nbsp;<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord mathdefault">k. (<span class="katex"><span class="katex-mathml"><span class="katex-html"><span class="base"><span class="strut"><span class="mord">1<span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord mathdefault">a<span class="mpunct">,<span class="mspace"><span class="mord mathdefault">b<span class="mpunct">,<span class="mspace"><span class="mord mathdefault">k<span class="mspace"><span class="mrel">&le;<span class="mspace"><span class="base"><span class="strut"><span class="mord mathdefault">n).</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3>Output Format</h3>
<p>For each query, output an integer in one line, without any additional space.</p>
</div>
<div id="samples">
<div class="jsk-margin-vertical-sm">
<h4 class="title jsk-margin-bottom-xs">样例输入</h4>
<pre>5 6<br />1 5
4 1
2 1
3 2
19
26
0
8
17
5 5 1
1 3 2
3 2 1
5 4 2
3 4 4
1 4 5</pre>
</div>
<div class="jsk-margin-vertical-sm">
<h4 class="title jsk-margin-bottom-xs">样例输出</h4>
<pre>17<br />19
26
25
0
19<br /><br />题意： 有一棵n个节点的树，每个节点上有个权值vi，现在q次询问：节点a到节点b的路径上，从a开始每k个节点跳一次所经过的所有节点的异或值为（a0,ak,a2k,a3k...）？<br /><br />思路： 建树，倍增算法记录每个节点的深度和2^i的祖先，处理并记录每个节点i到根节点间隔为k（1,2,3&hellip;&hellip;100）的异或值dp[i][k]。当k&lt;=100时，使用记录的异或值dp计算a到b间隔为k的异或值；当k&gt;100时，直接从a走到b，每次跳动使用倍增的信息（快速跳动）。<br /><br />注：这道题是2017年打西安网络赛时没过的题，当时其实代码写的很接近了，测数据都没问题，一直检查不出来，我也一直惦记着这道题。本科毕业后读研，又看过一次还是没找出原因，今天五一放假，没啥事儿，我又看了一遍当时写的代码，突然发现没初始化fa数组，心想难道是计蒜客网站编译器不是默认未初始化的值为0？加上fa的初始化后提交了一把，过了！！！<br />My God！ 心心念念的这道题竟然是这个原因没过，气呀。不过，今天总算是找到原因了，哈哈~  又一次想起来西安正式赛的时候，一道铜牌题没过&ldquo;LOL BP&rdquo;导致没拿到银牌，可惜的是当时的银牌题都过了，唉~ 与银失之交臂。现在是研究生了，很少刷题了，以后要少看剧，多看看相关的图形学的专业书，充实自己，找个好工作。<br /><br />代码如下：</pre>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">  1</span> <span style="color: #008000;">//</span><span style="color: #008000; text-decoration: underline;">https://nanti.jisuanke.com/t/A1273</span><span style="color: #008000;"> 《Xor》</span>
<span style="color: #008080;">  2</span> #include &lt;iostream&gt;
<span style="color: #008080;">  3</span> #include &lt;algorithm&gt;
<span style="color: #008080;">  4</span> #include &lt;cstdio&gt;
<span style="color: #008080;">  5</span> #include &lt;cstring&gt;
<span style="color: #008080;">  6</span> <span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;
</span><span style="color: #008080;">  7</span> <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> N = 5e4 + <span style="color: #800080;">5</span><span style="color: #000000;">;
</span><span style="color: #008080;">  8</span> <span style="color: #0000ff;">int</span> fa[N][<span style="color: #800080;">20</span><span style="color: #000000;">], deep[N], head[N];
</span><span style="color: #008080;">  9</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> v[N], cnt;
</span><span style="color: #008080;"> 10</span> <span style="color: #0000ff;">bool</span><span style="color: #000000;"> vis[N];
</span><span style="color: #008080;"> 11</span> <span style="color: #0000ff;">int</span> dp[N][<span style="color: #800080;">105</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 12</span> <span style="color: #0000ff;">struct</span><span style="color: #000000;"> data
</span><span style="color: #008080;"> 13</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 14</span>     <span style="color: #0000ff;">int</span><span style="color: #000000;"> to, next;
</span><span style="color: #008080;"> 15</span> }e[<span style="color: #800080;">2</span> *<span style="color: #000000;"> N];
</span><span style="color: #008080;"> 16</span> 
<span style="color: #008080;"> 17</span> <span style="color: #0000ff;">void</span> insert(<span style="color: #0000ff;">int</span> u, <span style="color: #0000ff;">int</span><span style="color: #000000;"> v)
</span><span style="color: #008080;"> 18</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 19</span>     e[++cnt].to =<span style="color: #000000;"> v;
</span><span style="color: #008080;"> 20</span>     e[cnt].next =<span style="color: #000000;"> head[u];
</span><span style="color: #008080;"> 21</span>     head[u] =<span style="color: #000000;"> cnt;
</span><span style="color: #008080;"> 22</span>     e[++cnt].to =<span style="color: #000000;"> u;
</span><span style="color: #008080;"> 23</span>     e[cnt].next =<span style="color: #000000;"> head[v];
</span><span style="color: #008080;"> 24</span>     head[v] =<span style="color: #000000;"> cnt;
</span><span style="color: #008080;"> 25</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 26</span> <span style="color: #0000ff;">int</span> cal(<span style="color: #0000ff;">int</span> x, <span style="color: #0000ff;">int</span><span style="color: #000000;"> t)
</span><span style="color: #008080;"> 27</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 28</span>     <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt;= <span style="color: #800080;">19</span>; i++<span style="color: #000000;">)
</span><span style="color: #008080;"> 29</span>         <span style="color: #0000ff;">if</span> (t&amp;(<span style="color: #800080;">1</span> &lt;&lt; i)) x =<span style="color: #000000;"> fa[x][i];
</span><span style="color: #008080;"> 30</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> x;
</span><span style="color: #008080;"> 31</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 32</span> <span style="color: #0000ff;">void</span> dfs(<span style="color: #0000ff;">int</span><span style="color: #000000;"> x)
</span><span style="color: #008080;"> 33</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 34</span>     vis[x] = <span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 35</span>     <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i &lt;= <span style="color: #800080;">19</span>; i++<span style="color: #000000;">)
</span><span style="color: #008080;"> 36</span> <span style="color: #000000;">    {
</span><span style="color: #008080;"> 37</span>         <span style="color: #0000ff;">if</span> (deep[x]&lt;(<span style="color: #800080;">1</span> &lt;&lt; i))<span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 38</span>         fa[x][i] = fa[fa[x][i - <span style="color: #800080;">1</span>]][i - <span style="color: #800080;">1</span>];<span style="color: #808080;">///</span><span style="color: #008000;">倍增处理祖先信息</span>
<span style="color: #008080;"> 39</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 40</span>     <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> k = <span style="color: #800080;">1</span>; k &lt;= <span style="color: #800080;">100</span>; k++<span style="color: #000000;">)
</span><span style="color: #008080;"> 41</span> <span style="color: #000000;">    {
</span><span style="color: #008080;"> 42</span>         dp[x][k] =<span style="color: #000000;"> v[x];
</span><span style="color: #008080;"> 43</span>         <span style="color: #0000ff;">if</span> (deep[x]&lt;k) <span style="color: #0000ff;">continue</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 44</span>         <span style="color: #0000ff;">int</span> p =<span style="color: #000000;"> cal(x, k);
</span><span style="color: #008080;"> 45</span>         dp[x][k] ^=<span style="color: #000000;"> dp[p][k];
</span><span style="color: #008080;"> 46</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 47</span>     <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = head[x]; i; i =<span style="color: #000000;"> e[i].next)
</span><span style="color: #008080;"> 48</span> <span style="color: #000000;">    {
</span><span style="color: #008080;"> 49</span>         <span style="color: #0000ff;">if</span> (vis[e[i].to]) <span style="color: #0000ff;">continue</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 50</span>         deep[e[i].to] = deep[x] + <span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 51</span>         fa[e[i].to][<span style="color: #800080;">0</span>] =<span style="color: #000000;"> x;
</span><span style="color: #008080;"> 52</span> <span style="color: #000000;">        dfs(e[i].to);
</span><span style="color: #008080;"> 53</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 54</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 55</span> <span style="color: #0000ff;">int</span> lca(<span style="color: #0000ff;">int</span> x, <span style="color: #0000ff;">int</span> y)<span style="color: #808080;">///</span><span style="color: #008000;">求lca</span>
<span style="color: #008080;"> 56</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 57</span>     <span style="color: #0000ff;">if</span> (deep[x]&lt;<span style="color: #000000;">deep[y]) swap(x, y);
</span><span style="color: #008080;"> 58</span>     x = cal(x, deep[x] -<span style="color: #000000;"> deep[y]);
</span><span style="color: #008080;"> 59</span>     <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">19</span>; i &gt;= <span style="color: #800080;">0</span>; i--<span style="color: #000000;">)
</span><span style="color: #008080;"> 60</span>         <span style="color: #0000ff;">if</span> (fa[x][i] !=<span style="color: #000000;"> fa[y][i])
</span><span style="color: #008080;"> 61</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 62</span>             x =<span style="color: #000000;"> fa[x][i];
</span><span style="color: #008080;"> 63</span>             y =<span style="color: #000000;"> fa[y][i];
</span><span style="color: #008080;"> 64</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 65</span>     <span style="color: #0000ff;">if</span> (x == y)<span style="color: #0000ff;">return</span><span style="color: #000000;"> x;
</span><span style="color: #008080;"> 66</span>     <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">return</span> fa[x][<span style="color: #800080;">0</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 67</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 68</span> 
<span style="color: #008080;"> 69</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> init()
</span><span style="color: #008080;"> 70</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 71</span>     cnt = <span style="color: #800080;">0</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 72</span>     memset(head, <span style="color: #800080;">0</span>, <span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(head));
</span><span style="color: #008080;"> 73</span>     memset(vis, <span style="color: #800080;">0</span>, <span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(vis));
</span><span style="color: #008080;"> 74</span>     memset(dp, <span style="color: #800080;">0</span>, <span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(dp));
</span><span style="color: #008080;"> 75</span>     memset(deep, <span style="color: #800080;">0</span>, <span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(deep));
</span><span style="color: #008080;"> 76</span>     memset(fa,<span style="color: #800080;">0</span>,<span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(fa));
</span><span style="color: #008080;"> 77</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 78</span> 
<span style="color: #008080;"> 79</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
</span><span style="color: #008080;"> 80</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 81</span>     <span style="color: #0000ff;">int</span><span style="color: #000000;"> n, q;
</span><span style="color: #008080;"> 82</span>     <span style="color: #0000ff;">while</span> (scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d%d</span><span style="color: #800000;">"</span>, &amp;n, &amp;q) !=<span style="color: #000000;"> EOF)
</span><span style="color: #008080;"> 83</span> <span style="color: #000000;">    {
</span><span style="color: #008080;"> 84</span> <span style="color: #000000;">        init();
</span><span style="color: #008080;"> 85</span>         <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i&lt;n; i++<span style="color: #000000;">)
</span><span style="color: #008080;"> 86</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 87</span>             <span style="color: #0000ff;">int</span> x, y; scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d%d</span><span style="color: #800000;">"</span>, &amp;x, &amp;<span style="color: #000000;">y);
</span><span style="color: #008080;"> 88</span> <span style="color: #000000;">            insert(x, y);
</span><span style="color: #008080;"> 89</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 90</span>         <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i &lt;= n; i++) scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>, &amp;<span style="color: #000000;">v[i]);
</span><span style="color: #008080;"> 91</span>         dfs(<span style="color: #800080;">1</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 92</span>         <span style="color: #0000ff;">while</span> (q--<span style="color: #000000;">)
</span><span style="color: #008080;"> 93</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 94</span>             <span style="color: #0000ff;">int</span> x, y, k; scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d%d%d</span><span style="color: #800000;">"</span>, &amp;x, &amp;y, &amp;<span style="color: #000000;">k);
</span><span style="color: #008080;"> 95</span>             <span style="color: #0000ff;">int</span> pa =<span style="color: #000000;"> lca(x, y);
</span><span style="color: #008080;"> 96</span>             <span style="color: #0000ff;">if</span> (k &lt;= <span style="color: #800080;">100</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 97</span> <span style="color: #000000;">            {
</span><span style="color: #008080;"> 98</span>                 <span style="color: #0000ff;">int</span> ans =<span style="color: #000000;"> dp[x][k];
</span><span style="color: #008080;"> 99</span>                 <span style="color: #0000ff;">int</span> h = (deep[x] - deep[pa]) %<span style="color: #000000;"> k;
</span><span style="color: #008080;">100</span>                 <span style="color: #0000ff;">int</span> t = k -<span style="color: #000000;"> h;
</span><span style="color: #008080;">101</span>                 <span style="color: #0000ff;">if</span> (deep[pa] &gt;=<span style="color: #000000;"> t)
</span><span style="color: #008080;">102</span> <span style="color: #000000;">                {
</span><span style="color: #008080;">103</span>                     <span style="color: #0000ff;">int</span> l =<span style="color: #000000;"> cal(pa, t);
</span><span style="color: #008080;">104</span>                     ans ^=<span style="color: #000000;"> dp[l][k];
</span><span style="color: #008080;">105</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">106</span>                 <span style="color: #0000ff;">int</span> r = k -<span style="color: #000000;"> h;
</span><span style="color: #008080;">107</span>                 t = deep[y] - deep[pa] -<span style="color: #000000;"> r;
</span><span style="color: #008080;">108</span>                 <span style="color: #0000ff;">if</span> (t&lt;<span style="color: #800080;">0</span>) <span style="color: #0000ff;">goto</span><span style="color: #000000;"> endw2;
</span><span style="color: #008080;">109</span>                 t %=<span style="color: #000000;"> k;
</span><span style="color: #008080;">110</span>                 y = cal(y, t);<span style="color: #808080;">///
</span><span style="color: #008080;">111</span>                 ans ^=<span style="color: #000000;"> dp[y][k];
</span><span style="color: #008080;">112</span>                 t = k -<span style="color: #000000;"> r;
</span><span style="color: #008080;">113</span>                 <span style="color: #0000ff;">if</span> (deep[pa] &gt;=<span style="color: #000000;"> t)
</span><span style="color: #008080;">114</span> <span style="color: #000000;">                {
</span><span style="color: #008080;">115</span>                     <span style="color: #0000ff;">int</span> l =<span style="color: #000000;"> cal(pa, t);
</span><span style="color: #008080;">116</span>                     ans ^=<span style="color: #000000;"> dp[l][k];
</span><span style="color: #008080;">117</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">118</span> <span style="color: #000000;">            endw2:;
</span><span style="color: #008080;">119</span>                 printf(<span style="color: #800000;">"</span><span style="color: #800000;">%d\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, ans);
</span><span style="color: #008080;">120</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">121</span>             <span style="color: #0000ff;">else</span>
<span style="color: #008080;">122</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">123</span>                 <span style="color: #0000ff;">int</span> ans = <span style="color: #800080;">0</span><span style="color: #000000;">;
</span><span style="color: #008080;">124</span>                 <span style="color: #0000ff;">while</span> (<span style="color: #800080;">1</span><span style="color: #000000;">)
</span><span style="color: #008080;">125</span> <span style="color: #000000;">                {
</span><span style="color: #008080;">126</span>                     ans ^=<span style="color: #000000;"> v[x];
</span><span style="color: #008080;">127</span>                     <span style="color: #0000ff;">if</span> (deep[x] - k&lt;deep[pa]) <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">128</span>                     x =<span style="color: #000000;"> cal(x, k);
</span><span style="color: #008080;">129</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">130</span>                 <span style="color: #0000ff;">int</span> l = k - (deep[x] -<span style="color: #000000;"> deep[pa]);
</span><span style="color: #008080;">131</span>                 <span style="color: #0000ff;">int</span> t = deep[y] - deep[pa] -<span style="color: #000000;"> l;
</span><span style="color: #008080;">132</span>                 <span style="color: #0000ff;">if</span> (t&lt;<span style="color: #800080;">0</span>) <span style="color: #0000ff;">goto</span><span style="color: #000000;"> endw;
</span><span style="color: #008080;">133</span>                 t %=<span style="color: #000000;"> k;
</span><span style="color: #008080;">134</span>                 y =<span style="color: #000000;"> cal(y, t);
</span><span style="color: #008080;">135</span>                 <span style="color: #0000ff;">while</span> (<span style="color: #800080;">1</span><span style="color: #000000;">)
</span><span style="color: #008080;">136</span> <span style="color: #000000;">                {
</span><span style="color: #008080;">137</span>                     ans ^=<span style="color: #000000;"> v[y];
</span><span style="color: #008080;">138</span>                     <span style="color: #0000ff;">if</span> (deep[y] - k &lt;= deep[pa]) <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">139</span>                     y =<span style="color: #000000;"> cal(y, k);
</span><span style="color: #008080;">140</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">141</span> <span style="color: #000000;">            endw:;
</span><span style="color: #008080;">142</span>                 printf(<span style="color: #800000;">"</span><span style="color: #800000;">%d\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, ans);
</span><span style="color: #008080;">143</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">144</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">145</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">146</span>     <span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
</span><span style="color: #008080;">147</span> <span style="color: #000000;">}
</span><span style="color: #008080;">148</span> <span style="color: #008000;">/*</span><span style="color: #008000;">*
</span><span style="color: #008080;">149</span> <span style="color: #008000;">8 11
</span><span style="color: #008080;">150</span> <span style="color: #008000;">1 2
</span><span style="color: #008080;">151</span> <span style="color: #008000;">2 3
</span><span style="color: #008080;">152</span> <span style="color: #008000;">2 4
</span><span style="color: #008080;">153</span> <span style="color: #008000;">1 5
</span><span style="color: #008080;">154</span> <span style="color: #008000;">5 6
</span><span style="color: #008080;">155</span> <span style="color: #008000;">5 7
</span><span style="color: #008080;">156</span> <span style="color: #008000;">4 8
</span><span style="color: #008080;">157</span> <span style="color: #008000;">3 5 6 2 7 0 1 10
</span><span style="color: #008080;">158</span> <span style="color: #008000;">1 8 1
</span><span style="color: #008080;">159</span> <span style="color: #008000;">answer=14
</span><span style="color: #008080;">160</span> <span style="color: #008000;">*/</span></pre>
</div>
<p>&nbsp;</p>
<pre><br /><br /></pre>
</div>
</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>